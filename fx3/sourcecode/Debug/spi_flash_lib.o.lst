   1              		.cpu arm926ej-s
   2              		.fpu softvfp
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 6
  10              		.eabi_attribute 34, 0
  11              		.eabi_attribute 18, 4
  12              		.file	"spi_flash_lib.c"
  13              		.text
  14              	.Ltext0:
  15              		.cfi_sections	.debug_frame
  16              		.align	2
  17              		.global	FlashSpiInit
  19              	FlashSpiInit:
  20              	.LFB0:
  21              		.file 1 "../spi_flash_lib.c"
   1:../spi_flash_lib.c **** /*
   2:../spi_flash_lib.c ****  * Copyright (c) 2013 Nuand LLC
   3:../spi_flash_lib.c ****  *
   4:../spi_flash_lib.c ****  * Permission is hereby granted, free of charge, to any person obtaining a copy
   5:../spi_flash_lib.c ****  * of this software and associated documentation files (the "Software"), to deal
   6:../spi_flash_lib.c ****  * in the Software without restriction, including without limitation the rights
   7:../spi_flash_lib.c ****  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   8:../spi_flash_lib.c ****  * copies of the Software, and to permit persons to whom the Software is
   9:../spi_flash_lib.c ****  * furnished to do so, subject to the following conditions:
  10:../spi_flash_lib.c ****  *
  11:../spi_flash_lib.c ****  * The above copyright notice and this permission notice shall be included in
  12:../spi_flash_lib.c ****  * all copies or substantial portions of the Software.
  13:../spi_flash_lib.c ****  *
  14:../spi_flash_lib.c ****  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  15:../spi_flash_lib.c ****  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  16:../spi_flash_lib.c ****  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  17:../spi_flash_lib.c ****  * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  18:../spi_flash_lib.c ****  * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  19:../spi_flash_lib.c ****  * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  20:../spi_flash_lib.c ****  * THE SOFTWARE.
  21:../spi_flash_lib.c ****  */
  22:../spi_flash_lib.c **** 
  23:../spi_flash_lib.c **** #include "cyu3system.h"
  24:../spi_flash_lib.c **** #include "cyu3os.h"
  25:../spi_flash_lib.c **** #include "cyu3dma.h"
  26:../spi_flash_lib.c **** #include "cyu3error.h"
  27:../spi_flash_lib.c **** #include "cyu3usb.h"
  28:../spi_flash_lib.c **** #include "cyu3uart.h"
  29:../spi_flash_lib.c **** #include "cyu3gpif.h"
  30:../spi_flash_lib.c **** #include "cyu3pib.h"
  31:../spi_flash_lib.c **** #include "cyu3gpio.h"
  32:../spi_flash_lib.c **** #include "pib_regs.h"
  33:../spi_flash_lib.c **** #include "cyu3spi.h"
  34:../spi_flash_lib.c **** #include "spi_flash_lib.h"
  35:../spi_flash_lib.c **** #include "stream_brd.h"
  36:../spi_flash_lib.c **** 
  37:../spi_flash_lib.c **** #define CHANGE_SPI_TO_LSB
  38:../spi_flash_lib.c **** 
  39:../spi_flash_lib.c **** /* SPI initialization for application. */
  40:../spi_flash_lib.c **** CyU3PReturnStatus_t FlashSpiInit(void)
  41:../spi_flash_lib.c **** {
  22              		.loc 1 41 0
  23              		.cfi_startproc
  24              		@ args = 0, pretend = 0, frame = 32
  25              		@ frame_needed = 1, uses_anonymous_args = 0
  26 0000 00482DE9 		stmfd	sp!, {fp, lr}
  27              	.LCFI0:
  28              		.cfi_def_cfa_offset 8
  29              		.cfi_offset 11, -8
  30              		.cfi_offset 14, -4
  31 0004 04B08DE2 		add	fp, sp, #4
  32              	.LCFI1:
  33              		.cfi_def_cfa 11, 4
  34 0008 20D04DE2 		sub	sp, sp, #32
  42:../spi_flash_lib.c ****     CyU3PSpiConfig_t spiConfig;
  43:../spi_flash_lib.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
  35              		.loc 1 43 0
  36 000c 0030A0E3 		mov	r3, #0
  37 0010 08300BE5 		str	r3, [fp, #-8]
  44:../spi_flash_lib.c **** 
  45:../spi_flash_lib.c ****     /* Start the SPI module and configure the master. */
  46:../spi_flash_lib.c ****     status = CyU3PSpiInit();
  38              		.loc 1 46 0
  39 0014 FEFFFFEB 		bl	CyU3PSpiInit
  40 0018 08000BE5 		str	r0, [fp, #-8]
  47:../spi_flash_lib.c ****     if (status != CY_U3P_SUCCESS) {
  41              		.loc 1 47 0
  42 001c 08301BE5 		ldr	r3, [fp, #-8]
  43 0020 000053E3 		cmp	r3, #0
  44 0024 0100000A 		beq	.L2
  48:../spi_flash_lib.c ****         return status;
  45              		.loc 1 48 0
  46 0028 08301BE5 		ldr	r3, [fp, #-8]
  47 002c 1C0000EA 		b	.L4
  48              	.L2:
  49:../spi_flash_lib.c ****     }
  50:../spi_flash_lib.c **** 
  51:../spi_flash_lib.c ****     /* Start the SPI master block. Run the SPI clock at 8MHz
  52:../spi_flash_lib.c ****      * and configure the word length to 8 bits. Also configure
  53:../spi_flash_lib.c ****      * the slave select using FW. */
  54:../spi_flash_lib.c ****     CyU3PMemSet((uint8_t *)&spiConfig, 0, sizeof(spiConfig));
  49              		.loc 1 54 0
  50 0030 24304BE2 		sub	r3, fp, #36
  51 0034 0300A0E1 		mov	r0, r3
  52 0038 0010A0E3 		mov	r1, #0
  53 003c 1C20A0E3 		mov	r2, #28
  54 0040 FEFFFFEB 		bl	CyU3PMemSet
  55:../spi_flash_lib.c ****     spiConfig.isLsbFirst = CyFalse;
  55              		.loc 1 55 0
  56 0044 0030A0E3 		mov	r3, #0
  57 0048 24300BE5 		str	r3, [fp, #-36]
  56:../spi_flash_lib.c ****     spiConfig.cpol       = CyTrue;
  58              		.loc 1 56 0
  59 004c 0130A0E3 		mov	r3, #1
  60 0050 20300BE5 		str	r3, [fp, #-32]
  57:../spi_flash_lib.c ****     spiConfig.ssnPol     = CyFalse;
  61              		.loc 1 57 0
  62 0054 0030A0E3 		mov	r3, #0
  63 0058 18300BE5 		str	r3, [fp, #-24]
  58:../spi_flash_lib.c ****     spiConfig.cpha       = CyTrue;
  64              		.loc 1 58 0
  65 005c 0130A0E3 		mov	r3, #1
  66 0060 1C300BE5 		str	r3, [fp, #-28]
  59:../spi_flash_lib.c ****     spiConfig.leadTime   = CY_U3P_SPI_SSN_LAG_LEAD_HALF_CLK;
  67              		.loc 1 59 0
  68 0064 0130A0E3 		mov	r3, #1
  69 0068 13304BE5 		strb	r3, [fp, #-19]
  60:../spi_flash_lib.c ****     spiConfig.lagTime    = CY_U3P_SPI_SSN_LAG_LEAD_HALF_CLK;
  70              		.loc 1 60 0
  71 006c 0130A0E3 		mov	r3, #1
  72 0070 12304BE5 		strb	r3, [fp, #-18]
  61:../spi_flash_lib.c ****     spiConfig.ssnCtrl    = CY_U3P_SPI_SSN_CTRL_FW;
  73              		.loc 1 61 0
  74 0074 0030A0E3 		mov	r3, #0
  75 0078 14304BE5 		strb	r3, [fp, #-20]
  62:../spi_flash_lib.c ****     spiConfig.clock      = 50 *1000000; //50 MHz
  76              		.loc 1 62 0
  77 007c 2C309FE5 		ldr	r3, .L5
  78 0080 10300BE5 		str	r3, [fp, #-16]
  63:../spi_flash_lib.c ****     spiConfig.wordLen    = 8;
  79              		.loc 1 63 0
  80 0084 0830A0E3 		mov	r3, #8
  81 0088 0C304BE5 		strb	r3, [fp, #-12]
  64:../spi_flash_lib.c **** 
  65:../spi_flash_lib.c ****     status = CyU3PSpiSetConfig(&spiConfig, NULL);
  82              		.loc 1 65 0
  83 008c 24304BE2 		sub	r3, fp, #36
  84 0090 0300A0E1 		mov	r0, r3
  85 0094 0010A0E3 		mov	r1, #0
  86 0098 FEFFFFEB 		bl	CyU3PSpiSetConfig
  87 009c 08000BE5 		str	r0, [fp, #-8]
  66:../spi_flash_lib.c **** 
  67:../spi_flash_lib.c ****     return status;
  88              		.loc 1 67 0
  89 00a0 08301BE5 		ldr	r3, [fp, #-8]
  90              	.L4:
  68:../spi_flash_lib.c **** }
  91              		.loc 1 68 0
  92 00a4 0300A0E1 		mov	r0, r3
  93 00a8 04D04BE2 		sub	sp, fp, #4
  94              		@ sp needed
  95 00ac 0088BDE8 		ldmfd	sp!, {fp, pc}
  96              	.L6:
  97              		.align	2
  98              	.L5:
  99 00b0 80F0FA02 		.word	50000000
 100              		.cfi_endproc
 101              	.LFE0:
 103              		.align	2
 104              		.global	Reconfigure_SPI_for_FPGA_PS
 106              	Reconfigure_SPI_for_FPGA_PS:
 107              	.LFB1:
  69:../spi_flash_lib.c **** 
  70:../spi_flash_lib.c **** void Reconfigure_SPI_for_FPGA_PS(void)
  71:../spi_flash_lib.c **** {
 108              		.loc 1 71 0
 109              		.cfi_startproc
 110              		@ args = 0, pretend = 0, frame = 32
 111              		@ frame_needed = 1, uses_anonymous_args = 0
 112 00b4 00482DE9 		stmfd	sp!, {fp, lr}
 113              	.LCFI2:
 114              		.cfi_def_cfa_offset 8
 115              		.cfi_offset 11, -8
 116              		.cfi_offset 14, -4
 117 00b8 04B08DE2 		add	fp, sp, #4
 118              	.LCFI3:
 119              		.cfi_def_cfa 11, 4
 120 00bc 20D04DE2 		sub	sp, sp, #32
  72:../spi_flash_lib.c ****     CyU3PSpiConfig_t spiConfig;
  73:../spi_flash_lib.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
 121              		.loc 1 73 0
 122 00c0 0030A0E3 		mov	r3, #0
 123 00c4 08300BE5 		str	r3, [fp, #-8]
  74:../spi_flash_lib.c **** 
  75:../spi_flash_lib.c ****     CyU3PMemSet ((uint8_t *)&spiConfig, 0, sizeof(spiConfig));
 124              		.loc 1 75 0
 125 00c8 24304BE2 		sub	r3, fp, #36
 126 00cc 0300A0E1 		mov	r0, r3
 127 00d0 0010A0E3 		mov	r1, #0
 128 00d4 1C20A0E3 		mov	r2, #28
 129 00d8 FEFFFFEB 		bl	CyU3PMemSet
  76:../spi_flash_lib.c ****     spiConfig.isLsbFirst = CyTrue;
 130              		.loc 1 76 0
 131 00dc 0130A0E3 		mov	r3, #1
 132 00e0 24300BE5 		str	r3, [fp, #-36]
  77:../spi_flash_lib.c ****     spiConfig.cpol       = CyFalse;
 133              		.loc 1 77 0
 134 00e4 0030A0E3 		mov	r3, #0
 135 00e8 20300BE5 		str	r3, [fp, #-32]
  78:../spi_flash_lib.c ****     spiConfig.ssnPol     = CyFalse;
 136              		.loc 1 78 0
 137 00ec 0030A0E3 		mov	r3, #0
 138 00f0 18300BE5 		str	r3, [fp, #-24]
  79:../spi_flash_lib.c ****     spiConfig.cpha       = CyFalse;
 139              		.loc 1 79 0
 140 00f4 0030A0E3 		mov	r3, #0
 141 00f8 1C300BE5 		str	r3, [fp, #-28]
  80:../spi_flash_lib.c ****     spiConfig.leadTime   = CY_U3P_SPI_SSN_LAG_LEAD_HALF_CLK;
 142              		.loc 1 80 0
 143 00fc 0130A0E3 		mov	r3, #1
 144 0100 13304BE5 		strb	r3, [fp, #-19]
  81:../spi_flash_lib.c ****     spiConfig.lagTime    = CY_U3P_SPI_SSN_LAG_LEAD_HALF_CLK;
 145              		.loc 1 81 0
 146 0104 0130A0E3 		mov	r3, #1
 147 0108 12304BE5 		strb	r3, [fp, #-18]
  82:../spi_flash_lib.c ****     spiConfig.ssnCtrl    = CY_U3P_SPI_SSN_CTRL_NONE;
 148              		.loc 1 82 0
 149 010c 0430A0E3 		mov	r3, #4
 150 0110 14304BE5 		strb	r3, [fp, #-20]
  83:../spi_flash_lib.c ****     spiConfig.clock      = 50 *1000000; //50 MHz
 151              		.loc 1 83 0
 152 0114 24309FE5 		ldr	r3, .L8
 153 0118 10300BE5 		str	r3, [fp, #-16]
  84:../spi_flash_lib.c ****     spiConfig.wordLen    = 8;
 154              		.loc 1 84 0
 155 011c 0830A0E3 		mov	r3, #8
 156 0120 0C304BE5 		strb	r3, [fp, #-12]
  85:../spi_flash_lib.c **** 
  86:../spi_flash_lib.c ****     status = CyU3PSpiSetConfig (&spiConfig, NULL);
 157              		.loc 1 86 0
 158 0124 24304BE2 		sub	r3, fp, #36
 159 0128 0300A0E1 		mov	r0, r3
 160 012c 0010A0E3 		mov	r1, #0
 161 0130 FEFFFFEB 		bl	CyU3PSpiSetConfig
 162 0134 08000BE5 		str	r0, [fp, #-8]
  87:../spi_flash_lib.c **** }
 163              		.loc 1 87 0
 164 0138 04D04BE2 		sub	sp, fp, #4
 165              		@ sp needed
 166 013c 0088BDE8 		ldmfd	sp!, {fp, pc}
 167              	.L9:
 168              		.align	2
 169              	.L8:
 170 0140 80F0FA02 		.word	50000000
 171              		.cfi_endproc
 172              	.LFE1:
 174              		.align	2
 175              		.global	FlashSpiDeInit
 177              	FlashSpiDeInit:
 178              	.LFB2:
  88:../spi_flash_lib.c **** 
  89:../spi_flash_lib.c **** CyU3PReturnStatus_t FlashSpiDeInit() {
 179              		.loc 1 89 0
 180              		.cfi_startproc
 181              		@ args = 0, pretend = 0, frame = 0
 182              		@ frame_needed = 1, uses_anonymous_args = 0
 183 0144 00482DE9 		stmfd	sp!, {fp, lr}
 184              	.LCFI4:
 185              		.cfi_def_cfa_offset 8
 186              		.cfi_offset 11, -8
 187              		.cfi_offset 14, -4
 188 0148 04B08DE2 		add	fp, sp, #4
 189              	.LCFI5:
 190              		.cfi_def_cfa 11, 4
  90:../spi_flash_lib.c **** 	return CyU3PSpiDeInit();
 191              		.loc 1 90 0
 192 014c FEFFFFEB 		bl	CyU3PSpiDeInit
 193 0150 0030A0E1 		mov	r3, r0
  91:../spi_flash_lib.c **** }
 194              		.loc 1 91 0
 195 0154 0300A0E1 		mov	r0, r3
 196 0158 0088BDE8 		ldmfd	sp!, {fp, pc}
 197              		.cfi_endproc
 198              	.LFE2:
 200              		.section	.rodata
 201              		.align	2
 202              	.LC0:
 203 0000 53504920 		.ascii	"SPI WR_ENABLE command failed\012\015\000"
 203      57525F45 
 203      4E41424C 
 203      4520636F 
 203      6D6D616E 
 204 001f 00       		.align	2
 205              	.LC1:
 206 0020 53504920 		.ascii	"SPI READ_STATUS command failed\012\015\000"
 206      52454144 
 206      5F535441 
 206      54555320 
 206      636F6D6D 
 207 0041 000000   		.align	2
 208              	.LC2:
 209 0044 53504920 		.ascii	"SPI status read failed\012\015\000"
 209      73746174 
 209      75732072 
 209      65616420 
 209      6661696C 
 210              		.text
 211              		.align	2
 212              		.global	CyFxSpiWaitForStatus
 214              	CyFxSpiWaitForStatus:
 215              	.LFB3:
  92:../spi_flash_lib.c **** 
  93:../spi_flash_lib.c **** /* Wait for the status response from the SPI flash. */
  94:../spi_flash_lib.c **** CyU3PReturnStatus_t CyFxSpiWaitForStatus(void)
  95:../spi_flash_lib.c **** {
 216              		.loc 1 95 0
 217              		.cfi_startproc
 218              		@ args = 0, pretend = 0, frame = 16
 219              		@ frame_needed = 1, uses_anonymous_args = 0
 220 015c 00482DE9 		stmfd	sp!, {fp, lr}
 221              	.LCFI6:
 222              		.cfi_def_cfa_offset 8
 223              		.cfi_offset 11, -8
 224              		.cfi_offset 14, -4
 225 0160 04B08DE2 		add	fp, sp, #4
 226              	.LCFI7:
 227              		.cfi_def_cfa 11, 4
 228 0164 10D04DE2 		sub	sp, sp, #16
  96:../spi_flash_lib.c ****     uint8_t buf[2], rd_buf[2];
  97:../spi_flash_lib.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
 229              		.loc 1 97 0
 230 0168 0030A0E3 		mov	r3, #0
 231 016c 08300BE5 		str	r3, [fp, #-8]
 232              	.L17:
  98:../spi_flash_lib.c **** 
  99:../spi_flash_lib.c ****     /* Wait for status response from SPI flash device. */
 100:../spi_flash_lib.c ****     do {
 101:../spi_flash_lib.c ****         buf[0] = 0x06;  /* Write enable command. */
 233              		.loc 1 101 0
 234 0170 0630A0E3 		mov	r3, #6
 235 0174 0C304BE5 		strb	r3, [fp, #-12]
 102:../spi_flash_lib.c **** 
 103:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_SPI_AS_SS, CyFalse);//CyU3PSpiSetSsnLine(CyFalse);
 236              		.loc 1 103 0
 237 0178 2D00A0E3 		mov	r0, #45
 238 017c 0010A0E3 		mov	r1, #0
 239 0180 FEFFFFEB 		bl	CyU3PGpioSetValue
 104:../spi_flash_lib.c ****         status = CyU3PSpiTransmitWords (buf, 1);
 240              		.loc 1 104 0
 241 0184 0C304BE2 		sub	r3, fp, #12
 242 0188 0300A0E1 		mov	r0, r3
 243 018c 0110A0E3 		mov	r1, #1
 244 0190 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 245 0194 08000BE5 		str	r0, [fp, #-8]
 105:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 246              		.loc 1 105 0
 247 0198 2D00A0E3 		mov	r0, #45
 248 019c 0110A0E3 		mov	r1, #1
 249 01a0 FEFFFFEB 		bl	CyU3PGpioSetValue
 106:../spi_flash_lib.c ****         if (status != CY_U3P_SUCCESS) {
 250              		.loc 1 106 0
 251 01a4 08301BE5 		ldr	r3, [fp, #-8]
 252 01a8 000053E3 		cmp	r3, #0
 253 01ac 0400000A 		beq	.L13
 107:../spi_flash_lib.c ****             CyU3PDebugPrint (2, "SPI WR_ENABLE command failed\n\r");
 254              		.loc 1 107 0
 255 01b0 0200A0E3 		mov	r0, #2
 256 01b4 CC109FE5 		ldr	r1, .L19
 257 01b8 FEFFFFEB 		bl	CyU3PDebugPrint
 108:../spi_flash_lib.c ****             return status;
 258              		.loc 1 108 0
 259 01bc 08301BE5 		ldr	r3, [fp, #-8]
 260 01c0 2D0000EA 		b	.L18
 261              	.L13:
 109:../spi_flash_lib.c ****         }
 110:../spi_flash_lib.c **** 
 111:../spi_flash_lib.c ****         buf[0] = 0x05;  /* Read status command */
 262              		.loc 1 111 0
 263 01c4 0530A0E3 		mov	r3, #5
 264 01c8 0C304BE5 		strb	r3, [fp, #-12]
 112:../spi_flash_lib.c **** 
 113:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_SPI_AS_SS, CyFalse);//CyU3PSpiSetSsnLine(CyFalse);
 265              		.loc 1 113 0
 266 01cc 2D00A0E3 		mov	r0, #45
 267 01d0 0010A0E3 		mov	r1, #0
 268 01d4 FEFFFFEB 		bl	CyU3PGpioSetValue
 114:../spi_flash_lib.c ****         status = CyU3PSpiTransmitWords(buf, 1);
 269              		.loc 1 114 0
 270 01d8 0C304BE2 		sub	r3, fp, #12
 271 01dc 0300A0E1 		mov	r0, r3
 272 01e0 0110A0E3 		mov	r1, #1
 273 01e4 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 274 01e8 08000BE5 		str	r0, [fp, #-8]
 115:../spi_flash_lib.c ****         if (status != CY_U3P_SUCCESS) {
 275              		.loc 1 115 0
 276 01ec 08301BE5 		ldr	r3, [fp, #-8]
 277 01f0 000053E3 		cmp	r3, #0
 278 01f4 0700000A 		beq	.L15
 116:../spi_flash_lib.c ****             CyU3PDebugPrint(2, "SPI READ_STATUS command failed\n\r");
 279              		.loc 1 116 0
 280 01f8 0200A0E3 		mov	r0, #2
 281 01fc 88109FE5 		ldr	r1, .L19+4
 282 0200 FEFFFFEB 		bl	CyU3PDebugPrint
 117:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 283              		.loc 1 117 0
 284 0204 2D00A0E3 		mov	r0, #45
 285 0208 0110A0E3 		mov	r1, #1
 286 020c FEFFFFEB 		bl	CyU3PGpioSetValue
 118:../spi_flash_lib.c ****             return status;
 287              		.loc 1 118 0
 288 0210 08301BE5 		ldr	r3, [fp, #-8]
 289 0214 180000EA 		b	.L18
 290              	.L15:
 119:../spi_flash_lib.c ****         }
 120:../spi_flash_lib.c **** 
 121:../spi_flash_lib.c ****         status = CyU3PSpiReceiveWords(rd_buf, 2);
 291              		.loc 1 121 0
 292 0218 10304BE2 		sub	r3, fp, #16
 293 021c 0300A0E1 		mov	r0, r3
 294 0220 0210A0E3 		mov	r1, #2
 295 0224 FEFFFFEB 		bl	CyU3PSpiReceiveWords
 296 0228 08000BE5 		str	r0, [fp, #-8]
 122:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 297              		.loc 1 122 0
 298 022c 2D00A0E3 		mov	r0, #45
 299 0230 0110A0E3 		mov	r1, #1
 300 0234 FEFFFFEB 		bl	CyU3PGpioSetValue
 123:../spi_flash_lib.c ****         if(status != CY_U3P_SUCCESS) {
 301              		.loc 1 123 0
 302 0238 08301BE5 		ldr	r3, [fp, #-8]
 303 023c 000053E3 		cmp	r3, #0
 304 0240 0400000A 		beq	.L16
 124:../spi_flash_lib.c ****             CyU3PDebugPrint(2, "SPI status read failed\n\r");
 305              		.loc 1 124 0
 306 0244 0200A0E3 		mov	r0, #2
 307 0248 40109FE5 		ldr	r1, .L19+8
 308 024c FEFFFFEB 		bl	CyU3PDebugPrint
 125:../spi_flash_lib.c ****             return status;
 309              		.loc 1 125 0
 310 0250 08301BE5 		ldr	r3, [fp, #-8]
 311 0254 080000EA 		b	.L18
 312              	.L16:
 126:../spi_flash_lib.c ****         }
 127:../spi_flash_lib.c **** 
 128:../spi_flash_lib.c ****     } while ((rd_buf[0] & 1) || (!(rd_buf[0] & 0x2)));
 313              		.loc 1 128 0
 314 0258 10305BE5 		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
 315 025c 013003E2 		and	r3, r3, #1
 316 0260 000053E3 		cmp	r3, #0
 317 0264 C1FFFF1A 		bne	.L17
 318              		.loc 1 128 0 is_stmt 0 discriminator 1
 319 0268 10305BE5 		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
 320 026c 023003E2 		and	r3, r3, #2
 321 0270 000053E3 		cmp	r3, #0
 322 0274 BDFFFF0A 		beq	.L17
 129:../spi_flash_lib.c **** 
 130:../spi_flash_lib.c ****     return CY_U3P_SUCCESS;
 323              		.loc 1 130 0 is_stmt 1
 324 0278 0030A0E3 		mov	r3, #0
 325              	.L18:
 131:../spi_flash_lib.c **** }
 326              		.loc 1 131 0
 327 027c 0300A0E1 		mov	r0, r3
 328 0280 04D04BE2 		sub	sp, fp, #4
 329              		@ sp needed
 330 0284 0088BDE8 		ldmfd	sp!, {fp, pc}
 331              	.L20:
 332              		.align	2
 333              	.L19:
 334 0288 00000000 		.word	.LC0
 335 028c 20000000 		.word	.LC1
 336 0290 44000000 		.word	.LC2
 337              		.cfi_endproc
 338              	.LFE3:
 340              		.global	spiFastRead
 341              		.bss
 342              		.align	2
 345              	spiFastRead:
 346 0000 00000000 		.space	4
 347              		.text
 348              		.align	2
 349              		.global	FlashSpiFastRead
 351              	FlashSpiFastRead:
 352              	.LFB4:
 132:../spi_flash_lib.c **** 
 133:../spi_flash_lib.c **** CyBool_t spiFastRead = CyFalse;
 134:../spi_flash_lib.c **** void FlashSpiFastRead(CyBool_t v) {
 353              		.loc 1 134 0
 354              		.cfi_startproc
 355              		@ args = 0, pretend = 0, frame = 8
 356              		@ frame_needed = 1, uses_anonymous_args = 0
 357              		@ link register save eliminated.
 358 0294 04B02DE5 		str	fp, [sp, #-4]!
 359              	.LCFI8:
 360              		.cfi_def_cfa_offset 4
 361              		.cfi_offset 11, -4
 362 0298 00B08DE2 		add	fp, sp, #0
 363              	.LCFI9:
 364              		.cfi_def_cfa_register 11
 365 029c 0CD04DE2 		sub	sp, sp, #12
 366 02a0 08000BE5 		str	r0, [fp, #-8]
 135:../spi_flash_lib.c ****     spiFastRead = v;
 367              		.loc 1 135 0
 368 02a4 10309FE5 		ldr	r3, .L22
 369 02a8 08201BE5 		ldr	r2, [fp, #-8]
 370 02ac 002083E5 		str	r2, [r3]
 136:../spi_flash_lib.c **** }
 371              		.loc 1 136 0
 372 02b0 00D04BE2 		sub	sp, fp, #0
 373              		@ sp needed
 374 02b4 04B09DE4 		ldr	fp, [sp], #4
 375 02b8 1EFF2FE1 		bx	lr
 376              	.L23:
 377              		.align	2
 378              	.L22:
 379 02bc 00000000 		.word	spiFastRead
 380              		.cfi_endproc
 381              	.LFE4:
 383              		.section	.rodata
 384 005d 000000   		.align	2
 385              	.LC3:
 386 0060 53504920 		.ascii	"SPI READ command failed\015\012\000"
 386      52454144 
 386      20636F6D 
 386      6D616E64 
 386      20666169 
 387 007a 0000     		.align	2
 388              	.LC4:
 389 007c 53504920 		.ascii	"SPI WRITE command failed\015\012\000"
 389      57524954 
 389      4520636F 
 389      6D6D616E 
 389      64206661 
 390 0097 00       		.text
 391              		.align	2
 392              		.global	FlashSpiTransfer
 394              	FlashSpiTransfer:
 395              	.LFB5:
 137:../spi_flash_lib.c **** 
 138:../spi_flash_lib.c **** /* SPI read / write for programmer application. */
 139:../spi_flash_lib.c **** CyU3PReturnStatus_t FlashSpiTransfer(uint16_t pageAddress, uint16_t byteCount, uint8_t *buffer, CyB
 140:../spi_flash_lib.c **** {
 396              		.loc 1 140 0
 397              		.cfi_startproc
 398              		@ args = 0, pretend = 0, frame = 32
 399              		@ frame_needed = 1, uses_anonymous_args = 0
 400 02c0 00482DE9 		stmfd	sp!, {fp, lr}
 401              	.LCFI10:
 402              		.cfi_def_cfa_offset 8
 403              		.cfi_offset 11, -8
 404              		.cfi_offset 14, -4
 405 02c4 04B08DE2 		add	fp, sp, #4
 406              	.LCFI11:
 407              		.cfi_def_cfa 11, 4
 408 02c8 20D04DE2 		sub	sp, sp, #32
 409 02cc 1C200BE5 		str	r2, [fp, #-28]
 410 02d0 20300BE5 		str	r3, [fp, #-32]
 411 02d4 B6014BE1 		strh	r0, [fp, #-22]	@ movhi
 412 02d8 B8114BE1 		strh	r1, [fp, #-24]	@ movhi
 141:../spi_flash_lib.c ****     uint8_t location[4];
 142:../spi_flash_lib.c ****     uint32_t byteAddress = 0;
 413              		.loc 1 142 0
 414 02dc 0030A0E3 		mov	r3, #0
 415 02e0 08300BE5 		str	r3, [fp, #-8]
 143:../spi_flash_lib.c ****     uint16_t pageCount = (byteCount / FLASH_PAGE_SIZE);
 416              		.loc 1 143 0
 417 02e4 B8315BE1 		ldrh	r3, [fp, #-24]
 418 02e8 2334A0E1 		mov	r3, r3, lsr #8
 419 02ec BA304BE1 		strh	r3, [fp, #-10]	@ movhi
 144:../spi_flash_lib.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
 420              		.loc 1 144 0
 421 02f0 0030A0E3 		mov	r3, #0
 422 02f4 10300BE5 		str	r3, [fp, #-16]
 145:../spi_flash_lib.c **** 
 146:../spi_flash_lib.c ****     spiFastRead = CyTrue;// force fast read
 423              		.loc 1 146 0
 424 02f8 4C329FE5 		ldr	r3, .L39
 425 02fc 0120A0E3 		mov	r2, #1
 426 0300 002083E5 		str	r2, [r3]
 147:../spi_flash_lib.c **** 
 148:../spi_flash_lib.c ****     if (byteCount == 0) {
 427              		.loc 1 148 0
 428 0304 B8315BE1 		ldrh	r3, [fp, #-24]
 429 0308 000053E3 		cmp	r3, #0
 430 030c 0100001A 		bne	.L25
 149:../spi_flash_lib.c ****         return CY_U3P_SUCCESS;
 431              		.loc 1 149 0
 432 0310 0030A0E3 		mov	r3, #0
 433 0314 890000EA 		b	.L38
 434              	.L25:
 150:../spi_flash_lib.c ****     }
 151:../spi_flash_lib.c **** 
 152:../spi_flash_lib.c ****     if ((byteCount % FLASH_PAGE_SIZE) != 0) {
 435              		.loc 1 152 0
 436 0318 B8315BE1 		ldrh	r3, [fp, #-24]	@ movhi
 437 031c FF3003E2 		and	r3, r3, #255
 438 0320 0338A0E1 		mov	r3, r3, asl #16
 439 0324 2338A0E1 		mov	r3, r3, lsr #16
 440 0328 000053E3 		cmp	r3, #0
 441 032c 0100000A 		beq	.L27
 153:../spi_flash_lib.c ****         return CY_U3P_ERROR_NOT_SUPPORTED;
 442              		.loc 1 153 0
 443 0330 4630A0E3 		mov	r3, #70
 444 0334 810000EA 		b	.L38
 445              	.L27:
 154:../spi_flash_lib.c ****     }
 155:../spi_flash_lib.c **** 
 156:../spi_flash_lib.c ****     byteAddress = pageAddress * FLASH_PAGE_SIZE;
 446              		.loc 1 156 0
 447 0338 B6315BE1 		ldrh	r3, [fp, #-22]
 448 033c 0334A0E1 		mov	r3, r3, asl #8
 449 0340 08300BE5 		str	r3, [fp, #-8]
 157:../spi_flash_lib.c **** 
 158:../spi_flash_lib.c ****     while (pageCount != 0) {
 450              		.loc 1 158 0
 451 0344 790000EA 		b	.L28
 452              	.L37:
 159:../spi_flash_lib.c ****         location[1] = (byteAddress >> 16) & 0xFF;       /* MS byte */
 453              		.loc 1 159 0
 454 0348 08301BE5 		ldr	r3, [fp, #-8]
 455 034c 2338A0E1 		mov	r3, r3, lsr #16
 456 0350 FF3003E2 		and	r3, r3, #255
 457 0354 13304BE5 		strb	r3, [fp, #-19]
 160:../spi_flash_lib.c ****         location[2] = (byteAddress >> 8) & 0xFF;
 458              		.loc 1 160 0
 459 0358 08301BE5 		ldr	r3, [fp, #-8]
 460 035c 2334A0E1 		mov	r3, r3, lsr #8
 461 0360 FF3003E2 		and	r3, r3, #255
 462 0364 12304BE5 		strb	r3, [fp, #-18]
 161:../spi_flash_lib.c ****         location[3] = byteAddress & 0xFF;               /* LS byte */
 463              		.loc 1 161 0
 464 0368 08301BE5 		ldr	r3, [fp, #-8]
 465 036c FF3003E2 		and	r3, r3, #255
 466 0370 11304BE5 		strb	r3, [fp, #-17]
 162:../spi_flash_lib.c **** 
 163:../spi_flash_lib.c ****         if (isRead) {
 467              		.loc 1 163 0
 468 0374 20301BE5 		ldr	r3, [fp, #-32]
 469 0378 000053E3 		cmp	r3, #0
 470 037c 2F00000A 		beq	.L29
 164:../spi_flash_lib.c ****             location[0] = 0x03; /* Read command. */
 471              		.loc 1 164 0
 472 0380 0330A0E3 		mov	r3, #3
 473 0384 14304BE5 		strb	r3, [fp, #-20]
 165:../spi_flash_lib.c **** 
 166:../spi_flash_lib.c ****             if (!spiFastRead) {
 474              		.loc 1 166 0
 475 0388 BC319FE5 		ldr	r3, .L39
 476 038c 003093E5 		ldr	r3, [r3]
 477 0390 000053E3 		cmp	r3, #0
 478 0394 0600001A 		bne	.L30
 167:../spi_flash_lib.c ****                 status = CyFxSpiWaitForStatus();
 479              		.loc 1 167 0
 480 0398 FEFFFFEB 		bl	CyFxSpiWaitForStatus
 481 039c 10000BE5 		str	r0, [fp, #-16]
 168:../spi_flash_lib.c ****                 if (status != CY_U3P_SUCCESS)
 482              		.loc 1 168 0
 483 03a0 10301BE5 		ldr	r3, [fp, #-16]
 484 03a4 000053E3 		cmp	r3, #0
 485 03a8 0100000A 		beq	.L30
 169:../spi_flash_lib.c ****                     return status;
 486              		.loc 1 169 0
 487 03ac 10301BE5 		ldr	r3, [fp, #-16]
 488 03b0 620000EA 		b	.L38
 489              	.L30:
 170:../spi_flash_lib.c ****             }
 171:../spi_flash_lib.c **** 
 172:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_SPI_AS_SS, CyFalse);//CyU3PSpiSetSsnLine(CyFalse);
 490              		.loc 1 172 0
 491 03b4 2D00A0E3 		mov	r0, #45
 492 03b8 0010A0E3 		mov	r1, #0
 493 03bc FEFFFFEB 		bl	CyU3PGpioSetValue
 173:../spi_flash_lib.c ****             status = CyU3PSpiTransmitWords(location, 4);
 494              		.loc 1 173 0
 495 03c0 14304BE2 		sub	r3, fp, #20
 496 03c4 0300A0E1 		mov	r0, r3
 497 03c8 0410A0E3 		mov	r1, #4
 498 03cc FEFFFFEB 		bl	CyU3PSpiTransmitWords
 499 03d0 10000BE5 		str	r0, [fp, #-16]
 174:../spi_flash_lib.c **** 
 175:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS) {
 500              		.loc 1 175 0
 501 03d4 10301BE5 		ldr	r3, [fp, #-16]
 502 03d8 000053E3 		cmp	r3, #0
 503 03dc 0700000A 		beq	.L31
 176:../spi_flash_lib.c ****                 CyU3PDebugPrint (2, "SPI READ command failed\r\n");
 504              		.loc 1 176 0
 505 03e0 0200A0E3 		mov	r0, #2
 506 03e4 64119FE5 		ldr	r1, .L39+4
 507 03e8 FEFFFFEB 		bl	CyU3PDebugPrint
 177:../spi_flash_lib.c ****                 CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine (CyTrue);
 508              		.loc 1 177 0
 509 03ec 2D00A0E3 		mov	r0, #45
 510 03f0 0110A0E3 		mov	r1, #1
 511 03f4 FEFFFFEB 		bl	CyU3PGpioSetValue
 178:../spi_flash_lib.c ****                 return status;
 512              		.loc 1 178 0
 513 03f8 10301BE5 		ldr	r3, [fp, #-16]
 514 03fc 4F0000EA 		b	.L38
 515              	.L31:
 179:../spi_flash_lib.c ****             }
 180:../spi_flash_lib.c **** 
 181:../spi_flash_lib.c ****             status = CyU3PSpiReceiveWords(buffer, FLASH_PAGE_SIZE);
 516              		.loc 1 181 0
 517 0400 1C001BE5 		ldr	r0, [fp, #-28]
 518 0404 011CA0E3 		mov	r1, #256
 519 0408 FEFFFFEB 		bl	CyU3PSpiReceiveWords
 520 040c 10000BE5 		str	r0, [fp, #-16]
 182:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS) {
 521              		.loc 1 182 0
 522 0410 10301BE5 		ldr	r3, [fp, #-16]
 523 0414 000053E3 		cmp	r3, #0
 524 0418 0400000A 		beq	.L32
 183:../spi_flash_lib.c ****             	CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 525              		.loc 1 183 0
 526 041c 2D00A0E3 		mov	r0, #45
 527 0420 0110A0E3 		mov	r1, #1
 528 0424 FEFFFFEB 		bl	CyU3PGpioSetValue
 184:../spi_flash_lib.c ****                 return status;
 529              		.loc 1 184 0
 530 0428 10301BE5 		ldr	r3, [fp, #-16]
 531 042c 430000EA 		b	.L38
 532              	.L32:
 185:../spi_flash_lib.c ****             }
 186:../spi_flash_lib.c **** 
 187:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 533              		.loc 1 187 0
 534 0430 2D00A0E3 		mov	r0, #45
 535 0434 0110A0E3 		mov	r1, #1
 536 0438 FEFFFFEB 		bl	CyU3PGpioSetValue
 537 043c 2C0000EA 		b	.L33
 538              	.L29:
 188:../spi_flash_lib.c ****         } else { /* Write */
 189:../spi_flash_lib.c ****             location[0] = 0x02; /* Write command */
 539              		.loc 1 189 0
 540 0440 0230A0E3 		mov	r3, #2
 541 0444 14304BE5 		strb	r3, [fp, #-20]
 190:../spi_flash_lib.c **** 
 191:../spi_flash_lib.c ****             status = CyFxSpiWaitForStatus();
 542              		.loc 1 191 0
 543 0448 FEFFFFEB 		bl	CyFxSpiWaitForStatus
 544 044c 10000BE5 		str	r0, [fp, #-16]
 192:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS)
 545              		.loc 1 192 0
 546 0450 10301BE5 		ldr	r3, [fp, #-16]
 547 0454 000053E3 		cmp	r3, #0
 548 0458 0100000A 		beq	.L34
 193:../spi_flash_lib.c ****                 return status;
 549              		.loc 1 193 0
 550 045c 10301BE5 		ldr	r3, [fp, #-16]
 551 0460 360000EA 		b	.L38
 552              	.L34:
 194:../spi_flash_lib.c **** 
 195:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_SPI_AS_SS, CyFalse);//CyU3PSpiSetSsnLine(CyFalse);
 553              		.loc 1 195 0
 554 0464 2D00A0E3 		mov	r0, #45
 555 0468 0010A0E3 		mov	r1, #0
 556 046c FEFFFFEB 		bl	CyU3PGpioSetValue
 196:../spi_flash_lib.c ****             status = CyU3PSpiTransmitWords(location, 4);
 557              		.loc 1 196 0
 558 0470 14304BE2 		sub	r3, fp, #20
 559 0474 0300A0E1 		mov	r0, r3
 560 0478 0410A0E3 		mov	r1, #4
 561 047c FEFFFFEB 		bl	CyU3PSpiTransmitWords
 562 0480 10000BE5 		str	r0, [fp, #-16]
 197:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS) {
 563              		.loc 1 197 0
 564 0484 10301BE5 		ldr	r3, [fp, #-16]
 565 0488 000053E3 		cmp	r3, #0
 566 048c 0700000A 		beq	.L35
 198:../spi_flash_lib.c ****                 CyU3PDebugPrint(2, "SPI WRITE command failed\r\n");
 567              		.loc 1 198 0
 568 0490 0200A0E3 		mov	r0, #2
 569 0494 B8109FE5 		ldr	r1, .L39+8
 570 0498 FEFFFFEB 		bl	CyU3PDebugPrint
 199:../spi_flash_lib.c ****                 CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 571              		.loc 1 199 0
 572 049c 2D00A0E3 		mov	r0, #45
 573 04a0 0110A0E3 		mov	r1, #1
 574 04a4 FEFFFFEB 		bl	CyU3PGpioSetValue
 200:../spi_flash_lib.c ****                 return status;
 575              		.loc 1 200 0
 576 04a8 10301BE5 		ldr	r3, [fp, #-16]
 577 04ac 230000EA 		b	.L38
 578              	.L35:
 201:../spi_flash_lib.c ****             }
 202:../spi_flash_lib.c **** 
 203:../spi_flash_lib.c **** 			#ifdef CHANGE_SPI_TO_LSB
 204:../spi_flash_lib.c ****             Reconfigure_SPI_for_FPGA_PS ();
 579              		.loc 1 204 0
 580 04b0 FEFFFFEB 		bl	Reconfigure_SPI_for_FPGA_PS
 205:../spi_flash_lib.c **** 			#endif
 206:../spi_flash_lib.c **** 
 207:../spi_flash_lib.c ****             status = CyU3PSpiTransmitWords(buffer, FLASH_PAGE_SIZE);
 581              		.loc 1 207 0
 582 04b4 1C001BE5 		ldr	r0, [fp, #-28]
 583 04b8 011CA0E3 		mov	r1, #256
 584 04bc FEFFFFEB 		bl	CyU3PSpiTransmitWords
 585 04c0 10000BE5 		str	r0, [fp, #-16]
 208:../spi_flash_lib.c **** 
 209:../spi_flash_lib.c **** 			#ifdef CHANGE_SPI_TO_LSB
 210:../spi_flash_lib.c ****             FlashSpiInit ();
 586              		.loc 1 210 0
 587 04c4 FEFFFFEB 		bl	FlashSpiInit
 211:../spi_flash_lib.c **** 			#endif
 212:../spi_flash_lib.c **** 
 213:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS) {
 588              		.loc 1 213 0
 589 04c8 10301BE5 		ldr	r3, [fp, #-16]
 590 04cc 000053E3 		cmp	r3, #0
 591 04d0 0400000A 		beq	.L36
 214:../spi_flash_lib.c ****             	CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 592              		.loc 1 214 0
 593 04d4 2D00A0E3 		mov	r0, #45
 594 04d8 0110A0E3 		mov	r1, #1
 595 04dc FEFFFFEB 		bl	CyU3PGpioSetValue
 215:../spi_flash_lib.c ****                 return status;
 596              		.loc 1 215 0
 597 04e0 10301BE5 		ldr	r3, [fp, #-16]
 598 04e4 150000EA 		b	.L38
 599              	.L36:
 216:../spi_flash_lib.c ****             }
 217:../spi_flash_lib.c **** 
 218:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 600              		.loc 1 218 0
 601 04e8 2D00A0E3 		mov	r0, #45
 602 04ec 0110A0E3 		mov	r1, #1
 603 04f0 FEFFFFEB 		bl	CyU3PGpioSetValue
 604              	.L33:
 219:../spi_flash_lib.c ****         }
 220:../spi_flash_lib.c **** 
 221:../spi_flash_lib.c ****         byteAddress += FLASH_PAGE_SIZE;
 605              		.loc 1 221 0
 606 04f4 08301BE5 		ldr	r3, [fp, #-8]
 607 04f8 013C83E2 		add	r3, r3, #256
 608 04fc 08300BE5 		str	r3, [fp, #-8]
 222:../spi_flash_lib.c ****         buffer += FLASH_PAGE_SIZE;
 609              		.loc 1 222 0
 610 0500 1C301BE5 		ldr	r3, [fp, #-28]
 611 0504 013C83E2 		add	r3, r3, #256
 612 0508 1C300BE5 		str	r3, [fp, #-28]
 223:../spi_flash_lib.c ****         pageCount--;
 613              		.loc 1 223 0
 614 050c BA305BE1 		ldrh	r3, [fp, #-10]
 615 0510 013043E2 		sub	r3, r3, #1
 616 0514 BA304BE1 		strh	r3, [fp, #-10]	@ movhi
 224:../spi_flash_lib.c **** 
 225:../spi_flash_lib.c ****         if (!spiFastRead)
 617              		.loc 1 225 0
 618 0518 2C309FE5 		ldr	r3, .L39
 619 051c 003093E5 		ldr	r3, [r3]
 620 0520 000053E3 		cmp	r3, #0
 621 0524 0100001A 		bne	.L28
 226:../spi_flash_lib.c ****             CyU3PThreadSleep(15);
 622              		.loc 1 226 0
 623 0528 0F00A0E3 		mov	r0, #15
 624 052c FEFFFFEB 		bl	_tx_thread_sleep
 625              	.L28:
 158:../spi_flash_lib.c ****         location[1] = (byteAddress >> 16) & 0xFF;       /* MS byte */
 626              		.loc 1 158 0 discriminator 1
 627 0530 BA305BE1 		ldrh	r3, [fp, #-10]
 628 0534 000053E3 		cmp	r3, #0
 629 0538 82FFFF1A 		bne	.L37
 227:../spi_flash_lib.c ****     }
 228:../spi_flash_lib.c **** 
 229:../spi_flash_lib.c ****     return CY_U3P_SUCCESS;
 630              		.loc 1 229 0
 631 053c 0030A0E3 		mov	r3, #0
 632              	.L38:
 230:../spi_flash_lib.c **** }
 633              		.loc 1 230 0
 634 0540 0300A0E1 		mov	r0, r3
 635 0544 04D04BE2 		sub	sp, fp, #4
 636              		@ sp needed
 637 0548 0088BDE8 		ldmfd	sp!, {fp, pc}
 638              	.L40:
 639              		.align	2
 640              	.L39:
 641 054c 00000000 		.word	spiFastRead
 642 0550 60000000 		.word	.LC3
 643 0554 7C000000 		.word	.LC4
 644              		.cfi_endproc
 645              	.LFE5:
 647              		.align	2
 648              		.global	FlashSpiEraseSector
 650              	FlashSpiEraseSector:
 651              	.LFB6:
 231:../spi_flash_lib.c **** 
 232:../spi_flash_lib.c **** /* Function to erase SPI flash sectors. */
 233:../spi_flash_lib.c **** CyU3PReturnStatus_t FlashSpiEraseSector(CyBool_t isErase, uint8_t sector)
 234:../spi_flash_lib.c **** {
 652              		.loc 1 234 0
 653              		.cfi_startproc
 654              		@ args = 0, pretend = 0, frame = 24
 655              		@ frame_needed = 1, uses_anonymous_args = 0
 656 0558 00482DE9 		stmfd	sp!, {fp, lr}
 657              	.LCFI12:
 658              		.cfi_def_cfa_offset 8
 659              		.cfi_offset 11, -8
 660              		.cfi_offset 14, -4
 661 055c 04B08DE2 		add	fp, sp, #4
 662              	.LCFI13:
 663              		.cfi_def_cfa 11, 4
 664 0560 18D04DE2 		sub	sp, sp, #24
 665 0564 18000BE5 		str	r0, [fp, #-24]
 666 0568 0130A0E1 		mov	r3, r1
 667 056c 19304BE5 		strb	r3, [fp, #-25]
 235:../spi_flash_lib.c ****     uint32_t temp = 0;
 668              		.loc 1 235 0
 669 0570 0030A0E3 		mov	r3, #0
 670 0574 08300BE5 		str	r3, [fp, #-8]
 236:../spi_flash_lib.c ****     uint8_t  location[4], rdBuf[2];
 237:../spi_flash_lib.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
 671              		.loc 1 237 0
 672 0578 0030A0E3 		mov	r3, #0
 673 057c 0C300BE5 		str	r3, [fp, #-12]
 238:../spi_flash_lib.c **** 
 239:../spi_flash_lib.c ****     location[0] = 0x06;  /* Write enable. */
 674              		.loc 1 239 0
 675 0580 0630A0E3 		mov	r3, #6
 676 0584 10304BE5 		strb	r3, [fp, #-16]
 240:../spi_flash_lib.c **** 
 241:../spi_flash_lib.c ****     CyU3PGpioSetValue (FX3_SPI_AS_SS, CyFalse);//CyU3PSpiSetSsnLine (CyFalse);
 677              		.loc 1 241 0
 678 0588 2D00A0E3 		mov	r0, #45
 679 058c 0010A0E3 		mov	r1, #0
 680 0590 FEFFFFEB 		bl	CyU3PGpioSetValue
 242:../spi_flash_lib.c ****     status = CyU3PSpiTransmitWords (location, 1);
 681              		.loc 1 242 0
 682 0594 10304BE2 		sub	r3, fp, #16
 683 0598 0300A0E1 		mov	r0, r3
 684 059c 0110A0E3 		mov	r1, #1
 685 05a0 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 686 05a4 0C000BE5 		str	r0, [fp, #-12]
 243:../spi_flash_lib.c ****     CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine (CyTrue);
 687              		.loc 1 243 0
 688 05a8 2D00A0E3 		mov	r0, #45
 689 05ac 0110A0E3 		mov	r1, #1
 690 05b0 FEFFFFEB 		bl	CyU3PGpioSetValue
 244:../spi_flash_lib.c ****     if (status != CY_U3P_SUCCESS)
 691              		.loc 1 244 0
 692 05b4 0C301BE5 		ldr	r3, [fp, #-12]
 693 05b8 000053E3 		cmp	r3, #0
 694 05bc 0100000A 		beq	.L42
 245:../spi_flash_lib.c ****         return status;
 695              		.loc 1 245 0
 696 05c0 0C301BE5 		ldr	r3, [fp, #-12]
 697 05c4 340000EA 		b	.L46
 698              	.L42:
 246:../spi_flash_lib.c **** 
 247:../spi_flash_lib.c ****     if (isErase)
 699              		.loc 1 247 0
 700 05c8 18301BE5 		ldr	r3, [fp, #-24]
 701 05cc 000053E3 		cmp	r3, #0
 702 05d0 1A00000A 		beq	.L44
 248:../spi_flash_lib.c ****     {
 249:../spi_flash_lib.c ****         location[0] = FLASH_CMD_SECTOR_ERASE; /* Sector erase. */
 703              		.loc 1 249 0
 704 05d4 2730E0E3 		mvn	r3, #39
 705 05d8 10304BE5 		strb	r3, [fp, #-16]
 250:../spi_flash_lib.c ****         temp        = sector * FLASH_SECTOR_SIZE;
 706              		.loc 1 250 0
 707 05dc 19305BE5 		ldrb	r3, [fp, #-25]	@ zero_extendqisi2
 708 05e0 0339A0E1 		mov	r3, r3, asl #18
 709 05e4 08300BE5 		str	r3, [fp, #-8]
 251:../spi_flash_lib.c ****         location[1] = (temp >> 16) & 0xFF;
 710              		.loc 1 251 0
 711 05e8 08301BE5 		ldr	r3, [fp, #-8]
 712 05ec 2338A0E1 		mov	r3, r3, lsr #16
 713 05f0 FF3003E2 		and	r3, r3, #255
 714 05f4 0F304BE5 		strb	r3, [fp, #-15]
 252:../spi_flash_lib.c ****         location[2] = (temp >> 8) & 0xFF;
 715              		.loc 1 252 0
 716 05f8 08301BE5 		ldr	r3, [fp, #-8]
 717 05fc 2334A0E1 		mov	r3, r3, lsr #8
 718 0600 FF3003E2 		and	r3, r3, #255
 719 0604 0E304BE5 		strb	r3, [fp, #-14]
 253:../spi_flash_lib.c ****         location[3] = temp & 0xFF;
 720              		.loc 1 253 0
 721 0608 08301BE5 		ldr	r3, [fp, #-8]
 722 060c FF3003E2 		and	r3, r3, #255
 723 0610 0D304BE5 		strb	r3, [fp, #-13]
 254:../spi_flash_lib.c **** 
 255:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_SPI_AS_SS, CyFalse);//CyU3PSpiSetSsnLine (CyFalse);
 724              		.loc 1 255 0
 725 0614 2D00A0E3 		mov	r0, #45
 726 0618 0010A0E3 		mov	r1, #0
 727 061c FEFFFFEB 		bl	CyU3PGpioSetValue
 256:../spi_flash_lib.c ****         status = CyU3PSpiTransmitWords (location, 4);
 728              		.loc 1 256 0
 729 0620 10304BE2 		sub	r3, fp, #16
 730 0624 0300A0E1 		mov	r0, r3
 731 0628 0410A0E3 		mov	r1, #4
 732 062c FEFFFFEB 		bl	CyU3PSpiTransmitWords
 733 0630 0C000BE5 		str	r0, [fp, #-12]
 257:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine (CyTrue);
 734              		.loc 1 257 0
 735 0634 2D00A0E3 		mov	r0, #45
 736 0638 0110A0E3 		mov	r1, #1
 737 063c FEFFFFEB 		bl	CyU3PGpioSetValue
 738              	.L44:
 258:../spi_flash_lib.c ****     }
 259:../spi_flash_lib.c **** 
 260:../spi_flash_lib.c ****     location[0] = 0x05; /* RDSTATUS */
 739              		.loc 1 260 0
 740 0640 0530A0E3 		mov	r3, #5
 741 0644 10304BE5 		strb	r3, [fp, #-16]
 742              	.L45:
 261:../spi_flash_lib.c ****     do {
 262:../spi_flash_lib.c ****     	CyU3PGpioSetValue (FX3_SPI_AS_SS, CyFalse);//CyU3PSpiSetSsnLine (CyFalse);
 743              		.loc 1 262 0 discriminator 1
 744 0648 2D00A0E3 		mov	r0, #45
 745 064c 0010A0E3 		mov	r1, #0
 746 0650 FEFFFFEB 		bl	CyU3PGpioSetValue
 263:../spi_flash_lib.c ****         status = CyU3PSpiTransmitWords (location, 1);
 747              		.loc 1 263 0 discriminator 1
 748 0654 10304BE2 		sub	r3, fp, #16
 749 0658 0300A0E1 		mov	r0, r3
 750 065c 0110A0E3 		mov	r1, #1
 751 0660 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 752 0664 0C000BE5 		str	r0, [fp, #-12]
 264:../spi_flash_lib.c ****         status = CyU3PSpiReceiveWords(rdBuf, 1);
 753              		.loc 1 264 0 discriminator 1
 754 0668 14304BE2 		sub	r3, fp, #20
 755 066c 0300A0E1 		mov	r0, r3
 756 0670 0110A0E3 		mov	r1, #1
 757 0674 FEFFFFEB 		bl	CyU3PSpiReceiveWords
 758 0678 0C000BE5 		str	r0, [fp, #-12]
 265:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);//CyU3PSpiSetSsnLine (CyTrue);
 759              		.loc 1 265 0 discriminator 1
 760 067c 2D00A0E3 		mov	r0, #45
 761 0680 0110A0E3 		mov	r1, #1
 762 0684 FEFFFFEB 		bl	CyU3PGpioSetValue
 266:../spi_flash_lib.c ****     } while(rdBuf[0] & 1);
 763              		.loc 1 266 0 discriminator 1
 764 0688 14305BE5 		ldrb	r3, [fp, #-20]	@ zero_extendqisi2
 765 068c 013003E2 		and	r3, r3, #1
 766 0690 000053E3 		cmp	r3, #0
 767 0694 EBFFFF1A 		bne	.L45
 267:../spi_flash_lib.c **** 
 268:../spi_flash_lib.c ****     return status;
 768              		.loc 1 268 0
 769 0698 0C301BE5 		ldr	r3, [fp, #-12]
 770              	.L46:
 269:../spi_flash_lib.c **** }
 771              		.loc 1 269 0
 772 069c 0300A0E1 		mov	r0, r3
 773 06a0 04D04BE2 		sub	sp, fp, #4
 774              		@ sp needed
 775 06a4 0088BDE8 		ldmfd	sp!, {fp, pc}
 776              		.cfi_endproc
 777              	.LFE6:
 779              		.align	2
 780              		.global	Flash_ID
 782              	Flash_ID:
 783              	.LFB7:
 270:../spi_flash_lib.c **** 
 271:../spi_flash_lib.c **** 
 272:../spi_flash_lib.c **** ///test function
 273:../spi_flash_lib.c **** void Flash_ID()
 274:../spi_flash_lib.c **** {
 784              		.loc 1 274 0
 785              		.cfi_startproc
 786              		@ args = 0, pretend = 0, frame = 8
 787              		@ frame_needed = 1, uses_anonymous_args = 0
 788 06a8 00482DE9 		stmfd	sp!, {fp, lr}
 789              	.LCFI14:
 790              		.cfi_def_cfa_offset 8
 791              		.cfi_offset 11, -8
 792              		.cfi_offset 14, -4
 793 06ac 04B08DE2 		add	fp, sp, #4
 794              	.LCFI15:
 795              		.cfi_def_cfa 11, 4
 796 06b0 08D04DE2 		sub	sp, sp, #8
 275:../spi_flash_lib.c **** 	uint8_t res1, res2, res3, spi_data_wr, spi_data_rd;
 276:../spi_flash_lib.c **** 
 277:../spi_flash_lib.c **** 	res1 = 0xa;
 797              		.loc 1 277 0
 798 06b4 0A30A0E3 		mov	r3, #10
 799 06b8 05304BE5 		strb	r3, [fp, #-5]
 278:../spi_flash_lib.c **** 	res2 = 0xb;
 800              		.loc 1 278 0
 801 06bc 0B30A0E3 		mov	r3, #11
 802 06c0 06304BE5 		strb	r3, [fp, #-6]
 279:../spi_flash_lib.c **** 	res3 = 0xc;
 803              		.loc 1 279 0
 804 06c4 0C30A0E3 		mov	r3, #12
 805 06c8 07304BE5 		strb	r3, [fp, #-7]
 280:../spi_flash_lib.c **** 
 281:../spi_flash_lib.c **** 	CyU3PGpioSetValue (FX3_SPI_AS_SS, CyFalse);//digitalWrite(_pinCE, LOW);
 806              		.loc 1 281 0
 807 06cc 2D00A0E3 		mov	r0, #45
 808 06d0 0010A0E3 		mov	r1, #0
 809 06d4 FEFFFFEB 		bl	CyU3PGpioSetValue
 282:../spi_flash_lib.c **** 
 283:../spi_flash_lib.c **** 	spi_data_wr = 0x9F;
 810              		.loc 1 283 0
 811 06d8 6030E0E3 		mvn	r3, #96
 812 06dc 08304BE5 		strb	r3, [fp, #-8]
 284:../spi_flash_lib.c **** 	CyU3PSpiTransmitWords (&spi_data_wr, 1);//_writeByte(0x9F);
 813              		.loc 1 284 0
 814 06e0 08304BE2 		sub	r3, fp, #8
 815 06e4 0300A0E1 		mov	r0, r3
 816 06e8 0110A0E3 		mov	r1, #1
 817 06ec FEFFFFEB 		bl	CyU3PSpiTransmitWords
 285:../spi_flash_lib.c **** 
 286:../spi_flash_lib.c **** 	CyU3PSpiReceiveWords (&res1, 1); //res1=_readByte();
 818              		.loc 1 286 0
 819 06f0 05304BE2 		sub	r3, fp, #5
 820 06f4 0300A0E1 		mov	r0, r3
 821 06f8 0110A0E3 		mov	r1, #1
 822 06fc FEFFFFEB 		bl	CyU3PSpiReceiveWords
 287:../spi_flash_lib.c **** 	CyU3PSpiReceiveWords (&res2, 1); //res2=_readByte();
 823              		.loc 1 287 0
 824 0700 06304BE2 		sub	r3, fp, #6
 825 0704 0300A0E1 		mov	r0, r3
 826 0708 0110A0E3 		mov	r1, #1
 827 070c FEFFFFEB 		bl	CyU3PSpiReceiveWords
 288:../spi_flash_lib.c **** 	CyU3PSpiReceiveWords (&res3, 1); //res3=_readByte();
 828              		.loc 1 288 0
 829 0710 07304BE2 		sub	r3, fp, #7
 830 0714 0300A0E1 		mov	r0, r3
 831 0718 0110A0E3 		mov	r1, #1
 832 071c FEFFFFEB 		bl	CyU3PSpiReceiveWords
 289:../spi_flash_lib.c **** 	CyU3PGpioSetValue (FX3_SPI_AS_SS, CyTrue);////digitalWrite(_pinCE, HIGH);
 833              		.loc 1 289 0
 834 0720 2D00A0E3 		mov	r0, #45
 835 0724 0110A0E3 		mov	r1, #1
 836 0728 FEFFFFEB 		bl	CyU3PGpioSetValue
 290:../spi_flash_lib.c **** 	/*ID_manufacturer=res1;
 291:../spi_flash_lib.c **** 	ID_type=res2;
 292:../spi_flash_lib.c **** 	ID_device=res3;
 293:../spi_flash_lib.c **** 
 294:../spi_flash_lib.c **** 	Text_manufacturer="xxx";
 295:../spi_flash_lib.c **** 	for(int i = 0; i<(sizeof(_device)/sizeof(struct _s_device)); i++)
 296:../spi_flash_lib.c **** 	{
 297:../spi_flash_lib.c **** 		if ((_device[i]._manufacturer_id==res1) & (_device[i]._type_id==res2) & (_device[i]._device_id==r
 298:../spi_flash_lib.c **** 		{
 299:../spi_flash_lib.c **** 			Text_manufacturer	= _device[i]._manufacturer_name;
 300:../spi_flash_lib.c **** 			Text_type			= _device[i]._device_type;
 301:../spi_flash_lib.c **** 			Text_device			= _device[i]._device_name;
 302:../spi_flash_lib.c **** 			Capacity			= _device[i]._size;
 303:../spi_flash_lib.c **** 			Pages				= _device[i]._pages+1;
 304:../spi_flash_lib.c **** 			_max_pages			= _device[i]._pages;
 305:../spi_flash_lib.c **** 			_cmd_write			= _device[i]._cmd_write;
 306:../spi_flash_lib.c **** 			_flags				= _device[i]._flags;
 307:../spi_flash_lib.c **** 		}
 308:../spi_flash_lib.c **** 	}
 309:../spi_flash_lib.c **** 	if (Text_manufacturer=="xxx")
 310:../spi_flash_lib.c **** 	{
 311:../spi_flash_lib.c **** 		Text_manufacturer	= "(Unknown manufacturer)";
 312:../spi_flash_lib.c **** 		Text_type			= "(Unknown type)";
 313:../spi_flash_lib.c **** 		Text_device			= "(Unknown device)";
 314:../spi_flash_lib.c **** 		Capacity			= 0;
 315:../spi_flash_lib.c **** 		ID_manufacturer		= 0;
 316:../spi_flash_lib.c **** 		ID_type				= 0;
 317:../spi_flash_lib.c **** 		ID_device			= 0;
 318:../spi_flash_lib.c **** 		_max_pages			= 0;
 319:../spi_flash_lib.c **** 		_cmd_write			= 0;
 320:../spi_flash_lib.c **** 		_flags				= 0;
 321:../spi_flash_lib.c **** 	}*/
 322:../spi_flash_lib.c **** 
 323:../spi_flash_lib.c **** }
 837              		.loc 1 323 0
 838 072c 04D04BE2 		sub	sp, fp, #4
 839              		@ sp needed
 840 0730 0088BDE8 		ldmfd	sp!, {fp, pc}
 841              		.cfi_endproc
 842              	.LFE7:
 844              		.align	2
 845              		.global	FX3_FlashSpiWaitForStatus
 847              	FX3_FlashSpiWaitForStatus:
 848              	.LFB8:
 324:../spi_flash_lib.c **** 
 325:../spi_flash_lib.c **** ////////////////functions for fx3 flash
 326:../spi_flash_lib.c **** 
 327:../spi_flash_lib.c **** /* Wait for the status response from the FX3 SPI flash. */
 328:../spi_flash_lib.c **** CyU3PReturnStatus_t FX3_FlashSpiWaitForStatus(void)
 329:../spi_flash_lib.c **** {
 849              		.loc 1 329 0
 850              		.cfi_startproc
 851              		@ args = 0, pretend = 0, frame = 16
 852              		@ frame_needed = 1, uses_anonymous_args = 0
 853 0734 00482DE9 		stmfd	sp!, {fp, lr}
 854              	.LCFI16:
 855              		.cfi_def_cfa_offset 8
 856              		.cfi_offset 11, -8
 857              		.cfi_offset 14, -4
 858 0738 04B08DE2 		add	fp, sp, #4
 859              	.LCFI17:
 860              		.cfi_def_cfa 11, 4
 861 073c 10D04DE2 		sub	sp, sp, #16
 330:../spi_flash_lib.c ****     uint8_t buf[2], rd_buf[2];
 331:../spi_flash_lib.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
 862              		.loc 1 331 0
 863 0740 0030A0E3 		mov	r3, #0
 864 0744 08300BE5 		str	r3, [fp, #-8]
 865              	.L53:
 332:../spi_flash_lib.c **** 
 333:../spi_flash_lib.c ****     /* Wait for status response from SPI flash device. */
 334:../spi_flash_lib.c ****     do {
 335:../spi_flash_lib.c ****         buf[0] = 0x06;  /* Write enable command. */
 866              		.loc 1 335 0
 867 0748 0630A0E3 		mov	r3, #6
 868 074c 0C304BE5 		strb	r3, [fp, #-12]
 336:../spi_flash_lib.c **** 
 337:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_FLASH1_SS, CyFalse);//CyU3PSpiSetSsnLine(CyFalse);
 869              		.loc 1 337 0
 870 0750 3600A0E3 		mov	r0, #54
 871 0754 0010A0E3 		mov	r1, #0
 872 0758 FEFFFFEB 		bl	CyU3PGpioSetValue
 338:../spi_flash_lib.c ****         status = CyU3PSpiTransmitWords (buf, 1);
 873              		.loc 1 338 0
 874 075c 0C304BE2 		sub	r3, fp, #12
 875 0760 0300A0E1 		mov	r0, r3
 876 0764 0110A0E3 		mov	r1, #1
 877 0768 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 878 076c 08000BE5 		str	r0, [fp, #-8]
 339:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 879              		.loc 1 339 0
 880 0770 3600A0E3 		mov	r0, #54
 881 0774 0110A0E3 		mov	r1, #1
 882 0778 FEFFFFEB 		bl	CyU3PGpioSetValue
 340:../spi_flash_lib.c ****         if (status != CY_U3P_SUCCESS) {
 883              		.loc 1 340 0
 884 077c 08301BE5 		ldr	r3, [fp, #-8]
 885 0780 000053E3 		cmp	r3, #0
 886 0784 0400000A 		beq	.L49
 341:../spi_flash_lib.c ****             CyU3PDebugPrint (2, "SPI WR_ENABLE command failed\n\r");
 887              		.loc 1 341 0
 888 0788 0200A0E3 		mov	r0, #2
 889 078c CC109FE5 		ldr	r1, .L55
 890 0790 FEFFFFEB 		bl	CyU3PDebugPrint
 342:../spi_flash_lib.c ****             return status;
 891              		.loc 1 342 0
 892 0794 08301BE5 		ldr	r3, [fp, #-8]
 893 0798 2D0000EA 		b	.L54
 894              	.L49:
 343:../spi_flash_lib.c ****         }
 344:../spi_flash_lib.c **** 
 345:../spi_flash_lib.c ****         buf[0] = 0x05;  /* Read status command */
 895              		.loc 1 345 0
 896 079c 0530A0E3 		mov	r3, #5
 897 07a0 0C304BE5 		strb	r3, [fp, #-12]
 346:../spi_flash_lib.c **** 
 347:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_FLASH1_SS, CyFalse);//CyU3PSpiSetSsnLine(CyFalse);
 898              		.loc 1 347 0
 899 07a4 3600A0E3 		mov	r0, #54
 900 07a8 0010A0E3 		mov	r1, #0
 901 07ac FEFFFFEB 		bl	CyU3PGpioSetValue
 348:../spi_flash_lib.c ****         status = CyU3PSpiTransmitWords(buf, 1);
 902              		.loc 1 348 0
 903 07b0 0C304BE2 		sub	r3, fp, #12
 904 07b4 0300A0E1 		mov	r0, r3
 905 07b8 0110A0E3 		mov	r1, #1
 906 07bc FEFFFFEB 		bl	CyU3PSpiTransmitWords
 907 07c0 08000BE5 		str	r0, [fp, #-8]
 349:../spi_flash_lib.c ****         if (status != CY_U3P_SUCCESS) {
 908              		.loc 1 349 0
 909 07c4 08301BE5 		ldr	r3, [fp, #-8]
 910 07c8 000053E3 		cmp	r3, #0
 911 07cc 0700000A 		beq	.L51
 350:../spi_flash_lib.c ****             CyU3PDebugPrint(2, "SPI READ_STATUS command failed\n\r");
 912              		.loc 1 350 0
 913 07d0 0200A0E3 		mov	r0, #2
 914 07d4 88109FE5 		ldr	r1, .L55+4
 915 07d8 FEFFFFEB 		bl	CyU3PDebugPrint
 351:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 916              		.loc 1 351 0
 917 07dc 3600A0E3 		mov	r0, #54
 918 07e0 0110A0E3 		mov	r1, #1
 919 07e4 FEFFFFEB 		bl	CyU3PGpioSetValue
 352:../spi_flash_lib.c ****             return status;
 920              		.loc 1 352 0
 921 07e8 08301BE5 		ldr	r3, [fp, #-8]
 922 07ec 180000EA 		b	.L54
 923              	.L51:
 353:../spi_flash_lib.c ****         }
 354:../spi_flash_lib.c **** 
 355:../spi_flash_lib.c ****         status = CyU3PSpiReceiveWords(rd_buf, 2);
 924              		.loc 1 355 0
 925 07f0 10304BE2 		sub	r3, fp, #16
 926 07f4 0300A0E1 		mov	r0, r3
 927 07f8 0210A0E3 		mov	r1, #2
 928 07fc FEFFFFEB 		bl	CyU3PSpiReceiveWords
 929 0800 08000BE5 		str	r0, [fp, #-8]
 356:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 930              		.loc 1 356 0
 931 0804 3600A0E3 		mov	r0, #54
 932 0808 0110A0E3 		mov	r1, #1
 933 080c FEFFFFEB 		bl	CyU3PGpioSetValue
 357:../spi_flash_lib.c ****         if(status != CY_U3P_SUCCESS) {
 934              		.loc 1 357 0
 935 0810 08301BE5 		ldr	r3, [fp, #-8]
 936 0814 000053E3 		cmp	r3, #0
 937 0818 0400000A 		beq	.L52
 358:../spi_flash_lib.c ****             CyU3PDebugPrint(2, "SPI status read failed\n\r");
 938              		.loc 1 358 0
 939 081c 0200A0E3 		mov	r0, #2
 940 0820 40109FE5 		ldr	r1, .L55+8
 941 0824 FEFFFFEB 		bl	CyU3PDebugPrint
 359:../spi_flash_lib.c ****             return status;
 942              		.loc 1 359 0
 943 0828 08301BE5 		ldr	r3, [fp, #-8]
 944 082c 080000EA 		b	.L54
 945              	.L52:
 360:../spi_flash_lib.c ****         }
 361:../spi_flash_lib.c **** 
 362:../spi_flash_lib.c ****     } while ((rd_buf[0] & 1) || (!(rd_buf[0] & 0x2)));
 946              		.loc 1 362 0
 947 0830 10305BE5 		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
 948 0834 013003E2 		and	r3, r3, #1
 949 0838 000053E3 		cmp	r3, #0
 950 083c C1FFFF1A 		bne	.L53
 951              		.loc 1 362 0 is_stmt 0 discriminator 1
 952 0840 10305BE5 		ldrb	r3, [fp, #-16]	@ zero_extendqisi2
 953 0844 023003E2 		and	r3, r3, #2
 954 0848 000053E3 		cmp	r3, #0
 955 084c BDFFFF0A 		beq	.L53
 363:../spi_flash_lib.c **** 
 364:../spi_flash_lib.c ****     return CY_U3P_SUCCESS;
 956              		.loc 1 364 0 is_stmt 1
 957 0850 0030A0E3 		mov	r3, #0
 958              	.L54:
 365:../spi_flash_lib.c **** }
 959              		.loc 1 365 0
 960 0854 0300A0E1 		mov	r0, r3
 961 0858 04D04BE2 		sub	sp, fp, #4
 962              		@ sp needed
 963 085c 0088BDE8 		ldmfd	sp!, {fp, pc}
 964              	.L56:
 965              		.align	2
 966              	.L55:
 967 0860 00000000 		.word	.LC0
 968 0864 20000000 		.word	.LC1
 969 0868 44000000 		.word	.LC2
 970              		.cfi_endproc
 971              	.LFE8:
 973              		.align	2
 974              		.global	FX3_FlashSpiTransfer
 976              	FX3_FlashSpiTransfer:
 977              	.LFB9:
 366:../spi_flash_lib.c **** 
 367:../spi_flash_lib.c **** /* FX3 SPI flash read / write for programmer application. */
 368:../spi_flash_lib.c **** CyU3PReturnStatus_t FX3_FlashSpiTransfer(uint16_t pageAddress, uint16_t byteCount, uint8_t *buffer,
 369:../spi_flash_lib.c **** {
 978              		.loc 1 369 0
 979              		.cfi_startproc
 980              		@ args = 0, pretend = 0, frame = 32
 981              		@ frame_needed = 1, uses_anonymous_args = 0
 982 086c 00482DE9 		stmfd	sp!, {fp, lr}
 983              	.LCFI18:
 984              		.cfi_def_cfa_offset 8
 985              		.cfi_offset 11, -8
 986              		.cfi_offset 14, -4
 987 0870 04B08DE2 		add	fp, sp, #4
 988              	.LCFI19:
 989              		.cfi_def_cfa 11, 4
 990 0874 20D04DE2 		sub	sp, sp, #32
 991 0878 1C200BE5 		str	r2, [fp, #-28]
 992 087c 20300BE5 		str	r3, [fp, #-32]
 993 0880 B6014BE1 		strh	r0, [fp, #-22]	@ movhi
 994 0884 B8114BE1 		strh	r1, [fp, #-24]	@ movhi
 370:../spi_flash_lib.c ****     uint8_t location[4];
 371:../spi_flash_lib.c ****     uint32_t byteAddress = 0;
 995              		.loc 1 371 0
 996 0888 0030A0E3 		mov	r3, #0
 997 088c 08300BE5 		str	r3, [fp, #-8]
 372:../spi_flash_lib.c ****     uint16_t pageCount = (byteCount / FLASH_PAGE_SIZE);
 998              		.loc 1 372 0
 999 0890 B8315BE1 		ldrh	r3, [fp, #-24]
 1000 0894 2334A0E1 		mov	r3, r3, lsr #8
 1001 0898 BA304BE1 		strh	r3, [fp, #-10]	@ movhi
 373:../spi_flash_lib.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
 1002              		.loc 1 373 0
 1003 089c 0030A0E3 		mov	r3, #0
 1004 08a0 10300BE5 		str	r3, [fp, #-16]
 374:../spi_flash_lib.c **** 
 375:../spi_flash_lib.c ****     spiFastRead = CyTrue;// force fast read
 1005              		.loc 1 375 0
 1006 08a4 44329FE5 		ldr	r3, .L72
 1007 08a8 0120A0E3 		mov	r2, #1
 1008 08ac 002083E5 		str	r2, [r3]
 376:../spi_flash_lib.c **** 
 377:../spi_flash_lib.c ****     if (byteCount == 0) {
 1009              		.loc 1 377 0
 1010 08b0 B8315BE1 		ldrh	r3, [fp, #-24]
 1011 08b4 000053E3 		cmp	r3, #0
 1012 08b8 0100001A 		bne	.L58
 378:../spi_flash_lib.c ****         return CY_U3P_SUCCESS;
 1013              		.loc 1 378 0
 1014 08bc 0030A0E3 		mov	r3, #0
 1015 08c0 870000EA 		b	.L71
 1016              	.L58:
 379:../spi_flash_lib.c ****     }
 380:../spi_flash_lib.c **** 
 381:../spi_flash_lib.c ****     if ((byteCount % FLASH_PAGE_SIZE) != 0) {
 1017              		.loc 1 381 0
 1018 08c4 B8315BE1 		ldrh	r3, [fp, #-24]	@ movhi
 1019 08c8 FF3003E2 		and	r3, r3, #255
 1020 08cc 0338A0E1 		mov	r3, r3, asl #16
 1021 08d0 2338A0E1 		mov	r3, r3, lsr #16
 1022 08d4 000053E3 		cmp	r3, #0
 1023 08d8 0100000A 		beq	.L60
 382:../spi_flash_lib.c ****         return CY_U3P_ERROR_NOT_SUPPORTED;
 1024              		.loc 1 382 0
 1025 08dc 4630A0E3 		mov	r3, #70
 1026 08e0 7F0000EA 		b	.L71
 1027              	.L60:
 383:../spi_flash_lib.c ****     }
 384:../spi_flash_lib.c **** 
 385:../spi_flash_lib.c ****     byteAddress = pageAddress * FLASH_PAGE_SIZE;
 1028              		.loc 1 385 0
 1029 08e4 B6315BE1 		ldrh	r3, [fp, #-22]
 1030 08e8 0334A0E1 		mov	r3, r3, asl #8
 1031 08ec 08300BE5 		str	r3, [fp, #-8]
 386:../spi_flash_lib.c **** 
 387:../spi_flash_lib.c ****     while (pageCount != 0) {
 1032              		.loc 1 387 0
 1033 08f0 770000EA 		b	.L61
 1034              	.L70:
 388:../spi_flash_lib.c ****         location[1] = (byteAddress >> 16) & 0xFF;       /* MS byte */
 1035              		.loc 1 388 0
 1036 08f4 08301BE5 		ldr	r3, [fp, #-8]
 1037 08f8 2338A0E1 		mov	r3, r3, lsr #16
 1038 08fc FF3003E2 		and	r3, r3, #255
 1039 0900 13304BE5 		strb	r3, [fp, #-19]
 389:../spi_flash_lib.c ****         location[2] = (byteAddress >> 8) & 0xFF;
 1040              		.loc 1 389 0
 1041 0904 08301BE5 		ldr	r3, [fp, #-8]
 1042 0908 2334A0E1 		mov	r3, r3, lsr #8
 1043 090c FF3003E2 		and	r3, r3, #255
 1044 0910 12304BE5 		strb	r3, [fp, #-18]
 390:../spi_flash_lib.c ****         location[3] = byteAddress & 0xFF;               /* LS byte */
 1045              		.loc 1 390 0
 1046 0914 08301BE5 		ldr	r3, [fp, #-8]
 1047 0918 FF3003E2 		and	r3, r3, #255
 1048 091c 11304BE5 		strb	r3, [fp, #-17]
 391:../spi_flash_lib.c **** 
 392:../spi_flash_lib.c ****         if (isRead) {
 1049              		.loc 1 392 0
 1050 0920 20301BE5 		ldr	r3, [fp, #-32]
 1051 0924 000053E3 		cmp	r3, #0
 1052 0928 2F00000A 		beq	.L62
 393:../spi_flash_lib.c ****             location[0] = 0x03; /* Read command. */
 1053              		.loc 1 393 0
 1054 092c 0330A0E3 		mov	r3, #3
 1055 0930 14304BE5 		strb	r3, [fp, #-20]
 394:../spi_flash_lib.c **** 
 395:../spi_flash_lib.c ****             if (!spiFastRead) {
 1056              		.loc 1 395 0
 1057 0934 B4319FE5 		ldr	r3, .L72
 1058 0938 003093E5 		ldr	r3, [r3]
 1059 093c 000053E3 		cmp	r3, #0
 1060 0940 0600001A 		bne	.L63
 396:../spi_flash_lib.c ****                 status = FX3_FlashSpiWaitForStatus();
 1061              		.loc 1 396 0
 1062 0944 FEFFFFEB 		bl	FX3_FlashSpiWaitForStatus
 1063 0948 10000BE5 		str	r0, [fp, #-16]
 397:../spi_flash_lib.c ****                 if (status != CY_U3P_SUCCESS)
 1064              		.loc 1 397 0
 1065 094c 10301BE5 		ldr	r3, [fp, #-16]
 1066 0950 000053E3 		cmp	r3, #0
 1067 0954 0100000A 		beq	.L63
 398:../spi_flash_lib.c ****                     return status;
 1068              		.loc 1 398 0
 1069 0958 10301BE5 		ldr	r3, [fp, #-16]
 1070 095c 600000EA 		b	.L71
 1071              	.L63:
 399:../spi_flash_lib.c ****             }
 400:../spi_flash_lib.c **** 
 401:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_FLASH1_SS, CyFalse);//CyU3PSpiSetSsnLine(CyFalse);
 1072              		.loc 1 401 0
 1073 0960 3600A0E3 		mov	r0, #54
 1074 0964 0010A0E3 		mov	r1, #0
 1075 0968 FEFFFFEB 		bl	CyU3PGpioSetValue
 402:../spi_flash_lib.c ****             status = CyU3PSpiTransmitWords(location, 4);
 1076              		.loc 1 402 0
 1077 096c 14304BE2 		sub	r3, fp, #20
 1078 0970 0300A0E1 		mov	r0, r3
 1079 0974 0410A0E3 		mov	r1, #4
 1080 0978 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 1081 097c 10000BE5 		str	r0, [fp, #-16]
 403:../spi_flash_lib.c **** 
 404:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS) {
 1082              		.loc 1 404 0
 1083 0980 10301BE5 		ldr	r3, [fp, #-16]
 1084 0984 000053E3 		cmp	r3, #0
 1085 0988 0700000A 		beq	.L64
 405:../spi_flash_lib.c ****                 CyU3PDebugPrint (2, "SPI READ command failed\r\n");
 1086              		.loc 1 405 0
 1087 098c 0200A0E3 		mov	r0, #2
 1088 0990 5C119FE5 		ldr	r1, .L72+4
 1089 0994 FEFFFFEB 		bl	CyU3PDebugPrint
 406:../spi_flash_lib.c ****                 CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine (CyTrue);
 1090              		.loc 1 406 0
 1091 0998 3600A0E3 		mov	r0, #54
 1092 099c 0110A0E3 		mov	r1, #1
 1093 09a0 FEFFFFEB 		bl	CyU3PGpioSetValue
 407:../spi_flash_lib.c ****                 return status;
 1094              		.loc 1 407 0
 1095 09a4 10301BE5 		ldr	r3, [fp, #-16]
 1096 09a8 4D0000EA 		b	.L71
 1097              	.L64:
 408:../spi_flash_lib.c ****             }
 409:../spi_flash_lib.c **** 
 410:../spi_flash_lib.c ****             status = CyU3PSpiReceiveWords(buffer, FLASH_PAGE_SIZE);
 1098              		.loc 1 410 0
 1099 09ac 1C001BE5 		ldr	r0, [fp, #-28]
 1100 09b0 011CA0E3 		mov	r1, #256
 1101 09b4 FEFFFFEB 		bl	CyU3PSpiReceiveWords
 1102 09b8 10000BE5 		str	r0, [fp, #-16]
 411:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS) {
 1103              		.loc 1 411 0
 1104 09bc 10301BE5 		ldr	r3, [fp, #-16]
 1105 09c0 000053E3 		cmp	r3, #0
 1106 09c4 0400000A 		beq	.L65
 412:../spi_flash_lib.c ****             	CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 1107              		.loc 1 412 0
 1108 09c8 3600A0E3 		mov	r0, #54
 1109 09cc 0110A0E3 		mov	r1, #1
 1110 09d0 FEFFFFEB 		bl	CyU3PGpioSetValue
 413:../spi_flash_lib.c ****                 return status;
 1111              		.loc 1 413 0
 1112 09d4 10301BE5 		ldr	r3, [fp, #-16]
 1113 09d8 410000EA 		b	.L71
 1114              	.L65:
 414:../spi_flash_lib.c ****             }
 415:../spi_flash_lib.c **** 
 416:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 1115              		.loc 1 416 0
 1116 09dc 3600A0E3 		mov	r0, #54
 1117 09e0 0110A0E3 		mov	r1, #1
 1118 09e4 FEFFFFEB 		bl	CyU3PGpioSetValue
 1119 09e8 2A0000EA 		b	.L66
 1120              	.L62:
 417:../spi_flash_lib.c ****         } else { /* Write */
 418:../spi_flash_lib.c ****             location[0] = 0x02; /* Write command */
 1121              		.loc 1 418 0
 1122 09ec 0230A0E3 		mov	r3, #2
 1123 09f0 14304BE5 		strb	r3, [fp, #-20]
 419:../spi_flash_lib.c **** 
 420:../spi_flash_lib.c ****             status = FX3_FlashSpiWaitForStatus();
 1124              		.loc 1 420 0
 1125 09f4 FEFFFFEB 		bl	FX3_FlashSpiWaitForStatus
 1126 09f8 10000BE5 		str	r0, [fp, #-16]
 421:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS)
 1127              		.loc 1 421 0
 1128 09fc 10301BE5 		ldr	r3, [fp, #-16]
 1129 0a00 000053E3 		cmp	r3, #0
 1130 0a04 0100000A 		beq	.L67
 422:../spi_flash_lib.c ****                 return status;
 1131              		.loc 1 422 0
 1132 0a08 10301BE5 		ldr	r3, [fp, #-16]
 1133 0a0c 340000EA 		b	.L71
 1134              	.L67:
 423:../spi_flash_lib.c **** 
 424:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_FLASH1_SS, CyFalse);//CyU3PSpiSetSsnLine(CyFalse);
 1135              		.loc 1 424 0
 1136 0a10 3600A0E3 		mov	r0, #54
 1137 0a14 0010A0E3 		mov	r1, #0
 1138 0a18 FEFFFFEB 		bl	CyU3PGpioSetValue
 425:../spi_flash_lib.c ****             status = CyU3PSpiTransmitWords(location, 4);
 1139              		.loc 1 425 0
 1140 0a1c 14304BE2 		sub	r3, fp, #20
 1141 0a20 0300A0E1 		mov	r0, r3
 1142 0a24 0410A0E3 		mov	r1, #4
 1143 0a28 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 1144 0a2c 10000BE5 		str	r0, [fp, #-16]
 426:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS) {
 1145              		.loc 1 426 0
 1146 0a30 10301BE5 		ldr	r3, [fp, #-16]
 1147 0a34 000053E3 		cmp	r3, #0
 1148 0a38 0700000A 		beq	.L68
 427:../spi_flash_lib.c ****                 CyU3PDebugPrint(2, "SPI WRITE command failed\r\n");
 1149              		.loc 1 427 0
 1150 0a3c 0200A0E3 		mov	r0, #2
 1151 0a40 B0109FE5 		ldr	r1, .L72+8
 1152 0a44 FEFFFFEB 		bl	CyU3PDebugPrint
 428:../spi_flash_lib.c ****                 CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 1153              		.loc 1 428 0
 1154 0a48 3600A0E3 		mov	r0, #54
 1155 0a4c 0110A0E3 		mov	r1, #1
 1156 0a50 FEFFFFEB 		bl	CyU3PGpioSetValue
 429:../spi_flash_lib.c ****                 return status;
 1157              		.loc 1 429 0
 1158 0a54 10301BE5 		ldr	r3, [fp, #-16]
 1159 0a58 210000EA 		b	.L71
 1160              	.L68:
 430:../spi_flash_lib.c ****             }
 431:../spi_flash_lib.c **** 
 432:../spi_flash_lib.c ****             status = CyU3PSpiTransmitWords(buffer, FLASH_PAGE_SIZE);
 1161              		.loc 1 432 0
 1162 0a5c 1C001BE5 		ldr	r0, [fp, #-28]
 1163 0a60 011CA0E3 		mov	r1, #256
 1164 0a64 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 1165 0a68 10000BE5 		str	r0, [fp, #-16]
 433:../spi_flash_lib.c **** 
 434:../spi_flash_lib.c ****             if (status != CY_U3P_SUCCESS) {
 1166              		.loc 1 434 0
 1167 0a6c 10301BE5 		ldr	r3, [fp, #-16]
 1168 0a70 000053E3 		cmp	r3, #0
 1169 0a74 0400000A 		beq	.L69
 435:../spi_flash_lib.c ****             	CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 1170              		.loc 1 435 0
 1171 0a78 3600A0E3 		mov	r0, #54
 1172 0a7c 0110A0E3 		mov	r1, #1
 1173 0a80 FEFFFFEB 		bl	CyU3PGpioSetValue
 436:../spi_flash_lib.c ****                 return status;
 1174              		.loc 1 436 0
 1175 0a84 10301BE5 		ldr	r3, [fp, #-16]
 1176 0a88 150000EA 		b	.L71
 1177              	.L69:
 437:../spi_flash_lib.c ****             }
 438:../spi_flash_lib.c **** 
 439:../spi_flash_lib.c ****             CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine(CyTrue);
 1178              		.loc 1 439 0
 1179 0a8c 3600A0E3 		mov	r0, #54
 1180 0a90 0110A0E3 		mov	r1, #1
 1181 0a94 FEFFFFEB 		bl	CyU3PGpioSetValue
 1182              	.L66:
 440:../spi_flash_lib.c ****         }
 441:../spi_flash_lib.c **** 
 442:../spi_flash_lib.c ****         byteAddress += FLASH_PAGE_SIZE;
 1183              		.loc 1 442 0
 1184 0a98 08301BE5 		ldr	r3, [fp, #-8]
 1185 0a9c 013C83E2 		add	r3, r3, #256
 1186 0aa0 08300BE5 		str	r3, [fp, #-8]
 443:../spi_flash_lib.c ****         buffer += FLASH_PAGE_SIZE;
 1187              		.loc 1 443 0
 1188 0aa4 1C301BE5 		ldr	r3, [fp, #-28]
 1189 0aa8 013C83E2 		add	r3, r3, #256
 1190 0aac 1C300BE5 		str	r3, [fp, #-28]
 444:../spi_flash_lib.c ****         pageCount--;
 1191              		.loc 1 444 0
 1192 0ab0 BA305BE1 		ldrh	r3, [fp, #-10]
 1193 0ab4 013043E2 		sub	r3, r3, #1
 1194 0ab8 BA304BE1 		strh	r3, [fp, #-10]	@ movhi
 445:../spi_flash_lib.c **** 
 446:../spi_flash_lib.c ****         if (!spiFastRead)
 1195              		.loc 1 446 0
 1196 0abc 2C309FE5 		ldr	r3, .L72
 1197 0ac0 003093E5 		ldr	r3, [r3]
 1198 0ac4 000053E3 		cmp	r3, #0
 1199 0ac8 0100001A 		bne	.L61
 447:../spi_flash_lib.c ****             CyU3PThreadSleep(15);
 1200              		.loc 1 447 0
 1201 0acc 0F00A0E3 		mov	r0, #15
 1202 0ad0 FEFFFFEB 		bl	_tx_thread_sleep
 1203              	.L61:
 387:../spi_flash_lib.c ****         location[1] = (byteAddress >> 16) & 0xFF;       /* MS byte */
 1204              		.loc 1 387 0 discriminator 1
 1205 0ad4 BA305BE1 		ldrh	r3, [fp, #-10]
 1206 0ad8 000053E3 		cmp	r3, #0
 1207 0adc 84FFFF1A 		bne	.L70
 448:../spi_flash_lib.c ****     }
 449:../spi_flash_lib.c **** 
 450:../spi_flash_lib.c ****     return CY_U3P_SUCCESS;
 1208              		.loc 1 450 0
 1209 0ae0 0030A0E3 		mov	r3, #0
 1210              	.L71:
 451:../spi_flash_lib.c **** }
 1211              		.loc 1 451 0
 1212 0ae4 0300A0E1 		mov	r0, r3
 1213 0ae8 04D04BE2 		sub	sp, fp, #4
 1214              		@ sp needed
 1215 0aec 0088BDE8 		ldmfd	sp!, {fp, pc}
 1216              	.L73:
 1217              		.align	2
 1218              	.L72:
 1219 0af0 00000000 		.word	spiFastRead
 1220 0af4 60000000 		.word	.LC3
 1221 0af8 7C000000 		.word	.LC4
 1222              		.cfi_endproc
 1223              	.LFE9:
 1225              		.align	2
 1226              		.global	FX3_FlashSpiEraseSector
 1228              	FX3_FlashSpiEraseSector:
 1229              	.LFB10:
 452:../spi_flash_lib.c **** 
 453:../spi_flash_lib.c **** /* Function to erase FX3 SPI flash sectors. */
 454:../spi_flash_lib.c **** CyU3PReturnStatus_t FX3_FlashSpiEraseSector(CyBool_t isErase, uint8_t sector)
 455:../spi_flash_lib.c **** {
 1230              		.loc 1 455 0
 1231              		.cfi_startproc
 1232              		@ args = 0, pretend = 0, frame = 24
 1233              		@ frame_needed = 1, uses_anonymous_args = 0
 1234 0afc 00482DE9 		stmfd	sp!, {fp, lr}
 1235              	.LCFI20:
 1236              		.cfi_def_cfa_offset 8
 1237              		.cfi_offset 11, -8
 1238              		.cfi_offset 14, -4
 1239 0b00 04B08DE2 		add	fp, sp, #4
 1240              	.LCFI21:
 1241              		.cfi_def_cfa 11, 4
 1242 0b04 18D04DE2 		sub	sp, sp, #24
 1243 0b08 18000BE5 		str	r0, [fp, #-24]
 1244 0b0c 0130A0E1 		mov	r3, r1
 1245 0b10 19304BE5 		strb	r3, [fp, #-25]
 456:../spi_flash_lib.c ****     uint32_t temp = 0;
 1246              		.loc 1 456 0
 1247 0b14 0030A0E3 		mov	r3, #0
 1248 0b18 08300BE5 		str	r3, [fp, #-8]
 457:../spi_flash_lib.c ****     uint8_t  location[4], rdBuf[2];
 458:../spi_flash_lib.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
 1249              		.loc 1 458 0
 1250 0b1c 0030A0E3 		mov	r3, #0
 1251 0b20 0C300BE5 		str	r3, [fp, #-12]
 459:../spi_flash_lib.c **** 
 460:../spi_flash_lib.c ****     location[0] = 0x06;  /* Write enable. */
 1252              		.loc 1 460 0
 1253 0b24 0630A0E3 		mov	r3, #6
 1254 0b28 10304BE5 		strb	r3, [fp, #-16]
 461:../spi_flash_lib.c **** 
 462:../spi_flash_lib.c ****     CyU3PGpioSetValue (FX3_FLASH1_SS, CyFalse);//CyU3PSpiSetSsnLine (CyFalse);
 1255              		.loc 1 462 0
 1256 0b2c 3600A0E3 		mov	r0, #54
 1257 0b30 0010A0E3 		mov	r1, #0
 1258 0b34 FEFFFFEB 		bl	CyU3PGpioSetValue
 463:../spi_flash_lib.c ****     status = CyU3PSpiTransmitWords (location, 1);
 1259              		.loc 1 463 0
 1260 0b38 10304BE2 		sub	r3, fp, #16
 1261 0b3c 0300A0E1 		mov	r0, r3
 1262 0b40 0110A0E3 		mov	r1, #1
 1263 0b44 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 1264 0b48 0C000BE5 		str	r0, [fp, #-12]
 464:../spi_flash_lib.c ****     CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine (CyTrue);
 1265              		.loc 1 464 0
 1266 0b4c 3600A0E3 		mov	r0, #54
 1267 0b50 0110A0E3 		mov	r1, #1
 1268 0b54 FEFFFFEB 		bl	CyU3PGpioSetValue
 465:../spi_flash_lib.c ****     if (status != CY_U3P_SUCCESS)
 1269              		.loc 1 465 0
 1270 0b58 0C301BE5 		ldr	r3, [fp, #-12]
 1271 0b5c 000053E3 		cmp	r3, #0
 1272 0b60 0100000A 		beq	.L75
 466:../spi_flash_lib.c ****         return status;
 1273              		.loc 1 466 0
 1274 0b64 0C301BE5 		ldr	r3, [fp, #-12]
 1275 0b68 340000EA 		b	.L79
 1276              	.L75:
 467:../spi_flash_lib.c **** 
 468:../spi_flash_lib.c ****     if (isErase)
 1277              		.loc 1 468 0
 1278 0b6c 18301BE5 		ldr	r3, [fp, #-24]
 1279 0b70 000053E3 		cmp	r3, #0
 1280 0b74 1A00000A 		beq	.L77
 469:../spi_flash_lib.c ****     {
 470:../spi_flash_lib.c ****         location[0] = FX3_FLASH_CMD_SECTOR_ERASE; /* Sector erase. */
 1281              		.loc 1 470 0
 1282 0b78 2730E0E3 		mvn	r3, #39
 1283 0b7c 10304BE5 		strb	r3, [fp, #-16]
 471:../spi_flash_lib.c ****         temp        = sector * FLASH_SECTOR_SIZE;
 1284              		.loc 1 471 0
 1285 0b80 19305BE5 		ldrb	r3, [fp, #-25]	@ zero_extendqisi2
 1286 0b84 0339A0E1 		mov	r3, r3, asl #18
 1287 0b88 08300BE5 		str	r3, [fp, #-8]
 472:../spi_flash_lib.c ****         location[1] = (temp >> 16) & 0xFF;
 1288              		.loc 1 472 0
 1289 0b8c 08301BE5 		ldr	r3, [fp, #-8]
 1290 0b90 2338A0E1 		mov	r3, r3, lsr #16
 1291 0b94 FF3003E2 		and	r3, r3, #255
 1292 0b98 0F304BE5 		strb	r3, [fp, #-15]
 473:../spi_flash_lib.c ****         location[2] = (temp >> 8) & 0xFF;
 1293              		.loc 1 473 0
 1294 0b9c 08301BE5 		ldr	r3, [fp, #-8]
 1295 0ba0 2334A0E1 		mov	r3, r3, lsr #8
 1296 0ba4 FF3003E2 		and	r3, r3, #255
 1297 0ba8 0E304BE5 		strb	r3, [fp, #-14]
 474:../spi_flash_lib.c ****         location[3] = temp & 0xFF;
 1298              		.loc 1 474 0
 1299 0bac 08301BE5 		ldr	r3, [fp, #-8]
 1300 0bb0 FF3003E2 		and	r3, r3, #255
 1301 0bb4 0D304BE5 		strb	r3, [fp, #-13]
 475:../spi_flash_lib.c **** 
 476:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_FLASH1_SS, CyFalse);//CyU3PSpiSetSsnLine (CyFalse);
 1302              		.loc 1 476 0
 1303 0bb8 3600A0E3 		mov	r0, #54
 1304 0bbc 0010A0E3 		mov	r1, #0
 1305 0bc0 FEFFFFEB 		bl	CyU3PGpioSetValue
 477:../spi_flash_lib.c ****         status = CyU3PSpiTransmitWords (location, 4);
 1306              		.loc 1 477 0
 1307 0bc4 10304BE2 		sub	r3, fp, #16
 1308 0bc8 0300A0E1 		mov	r0, r3
 1309 0bcc 0410A0E3 		mov	r1, #4
 1310 0bd0 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 1311 0bd4 0C000BE5 		str	r0, [fp, #-12]
 478:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine (CyTrue);
 1312              		.loc 1 478 0
 1313 0bd8 3600A0E3 		mov	r0, #54
 1314 0bdc 0110A0E3 		mov	r1, #1
 1315 0be0 FEFFFFEB 		bl	CyU3PGpioSetValue
 1316              	.L77:
 479:../spi_flash_lib.c ****     }
 480:../spi_flash_lib.c **** 
 481:../spi_flash_lib.c ****     location[0] = 0x05; /* RDSTATUS */
 1317              		.loc 1 481 0
 1318 0be4 0530A0E3 		mov	r3, #5
 1319 0be8 10304BE5 		strb	r3, [fp, #-16]
 1320              	.L78:
 482:../spi_flash_lib.c ****     do {
 483:../spi_flash_lib.c ****     	CyU3PGpioSetValue (FX3_FLASH1_SS, CyFalse);//CyU3PSpiSetSsnLine (CyFalse);
 1321              		.loc 1 483 0 discriminator 1
 1322 0bec 3600A0E3 		mov	r0, #54
 1323 0bf0 0010A0E3 		mov	r1, #0
 1324 0bf4 FEFFFFEB 		bl	CyU3PGpioSetValue
 484:../spi_flash_lib.c ****         status = CyU3PSpiTransmitWords (location, 1);
 1325              		.loc 1 484 0 discriminator 1
 1326 0bf8 10304BE2 		sub	r3, fp, #16
 1327 0bfc 0300A0E1 		mov	r0, r3
 1328 0c00 0110A0E3 		mov	r1, #1
 1329 0c04 FEFFFFEB 		bl	CyU3PSpiTransmitWords
 1330 0c08 0C000BE5 		str	r0, [fp, #-12]
 485:../spi_flash_lib.c ****         status = CyU3PSpiReceiveWords(rdBuf, 1);
 1331              		.loc 1 485 0 discriminator 1
 1332 0c0c 14304BE2 		sub	r3, fp, #20
 1333 0c10 0300A0E1 		mov	r0, r3
 1334 0c14 0110A0E3 		mov	r1, #1
 1335 0c18 FEFFFFEB 		bl	CyU3PSpiReceiveWords
 1336 0c1c 0C000BE5 		str	r0, [fp, #-12]
 486:../spi_flash_lib.c ****         CyU3PGpioSetValue (FX3_FLASH1_SS, CyTrue);//CyU3PSpiSetSsnLine (CyTrue);
 1337              		.loc 1 486 0 discriminator 1
 1338 0c20 3600A0E3 		mov	r0, #54
 1339 0c24 0110A0E3 		mov	r1, #1
 1340 0c28 FEFFFFEB 		bl	CyU3PGpioSetValue
 487:../spi_flash_lib.c ****     } while(rdBuf[0] & 1);
 1341              		.loc 1 487 0 discriminator 1
 1342 0c2c 14305BE5 		ldrb	r3, [fp, #-20]	@ zero_extendqisi2
 1343 0c30 013003E2 		and	r3, r3, #1
 1344 0c34 000053E3 		cmp	r3, #0
 1345 0c38 EBFFFF1A 		bne	.L78
 488:../spi_flash_lib.c **** 
 489:../spi_flash_lib.c ****     return status;
 1346              		.loc 1 489 0
 1347 0c3c 0C301BE5 		ldr	r3, [fp, #-12]
 1348              	.L79:
 490:../spi_flash_lib.c **** }
 1349              		.loc 1 490 0
 1350 0c40 0300A0E1 		mov	r0, r3
 1351 0c44 04D04BE2 		sub	sp, fp, #4
 1352              		@ sp needed
 1353 0c48 0088BDE8 		ldmfd	sp!, {fp, pc}
 1354              		.cfi_endproc
 1355              	.LFE10:
 1357              	.Letext0:
 1358              		.file 2 "c:\\program files (x86)\\cypress\\ez-usb fx3 sdk\\1.3\\arm gcc\\arm-none-eabi\\include\\s
 1359              		.file 3 "C:\\Program Files (x86)\\Cypress\\EZ-USB FX3 SDK\\1.3\\firmware\\u3p_firmware\\inc/cyu3ty
 1360              		.file 4 "C:\\Program Files (x86)\\Cypress\\EZ-USB FX3 SDK\\1.3\\firmware\\u3p_firmware\\inc/cyu3dm
 1361              		.file 5 "C:\\Program Files (x86)\\Cypress\\EZ-USB FX3 SDK\\1.3\\firmware\\u3p_firmware\\inc/cyu3er
 1362              		.file 6 "C:\\Program Files (x86)\\Cypress\\EZ-USB FX3 SDK\\1.3\\firmware\\u3p_firmware\\inc/cyu3sp
DEFINED SYMBOLS
                            *ABS*:00000000 spi_flash_lib.c
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:16     .text:00000000 $a
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:19     .text:00000000 FlashSpiInit
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:99     .text:000000b0 $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:103    .text:000000b4 $a
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:106    .text:000000b4 Reconfigure_SPI_for_FPGA_PS
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:170    .text:00000140 $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:174    .text:00000144 $a
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:177    .text:00000144 FlashSpiDeInit
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:201    .rodata:00000000 $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:214    .text:0000015c CyFxSpiWaitForStatus
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:334    .text:00000288 $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:345    .bss:00000000 spiFastRead
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:342    .bss:00000000 $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:348    .text:00000294 $a
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:351    .text:00000294 FlashSpiFastRead
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:379    .text:000002bc $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:391    .text:000002c0 $a
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:394    .text:000002c0 FlashSpiTransfer
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:641    .text:0000054c $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:647    .text:00000558 $a
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:650    .text:00000558 FlashSpiEraseSector
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:782    .text:000006a8 Flash_ID
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:847    .text:00000734 FX3_FlashSpiWaitForStatus
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:967    .text:00000860 $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:973    .text:0000086c $a
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:976    .text:0000086c FX3_FlashSpiTransfer
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:1219   .text:00000af0 $d
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:1225   .text:00000afc $a
C:\Users\Dovydas\AppData\Local\Temp\cc6volNw.s:1228   .text:00000afc FX3_FlashSpiEraseSector
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
CyU3PSpiInit
CyU3PMemSet
CyU3PSpiSetConfig
CyU3PSpiDeInit
CyU3PGpioSetValue
CyU3PSpiTransmitWords
CyU3PDebugPrint
CyU3PSpiReceiveWords
_tx_thread_sleep
